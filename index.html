<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PowerBots360 — Catalogue & Paiement</title>
<meta name="theme-color" content="#0f172a">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0b1020;
    --panel:rgba(8,12,24,.82);
    --panel-strong:rgba(8,12,24,.92);
    --panel-soft:rgba(255,255,255,.06);
    --border:rgba(255,255,255,.12);
    --text:#e5e7eb;
    --muted:#94a3b8;
    --brand:#22d3ee;
    --brand2:#2563eb;
  }
  *,*::before,*::after{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    color:var(--text);
    background:var(--bg) url('https://i.postimg.cc/qRzJKc7j/IMG-3273.jpg') center/cover fixed no-repeat;
  }
  a{color:inherit;text-decoration:none}
  button{font:inherit;cursor:pointer}
  img{max-width:100%;display:block}

  /* overlay global pour la lisibilité */
  .bg-overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(2,6,23,.55),rgba(2,6,23,.25) 35%,rgba(2,6,23,.55));pointer-events:none;z-index:0}
  /* personnage intégré au décor, sans carré (masque radial) */
  .bg-character{
    position:fixed;right:-4vw;bottom:-6vh;width:58vmin;height:58vmin;z-index:0;pointer-events:none;opacity:.16;
    background:url('https://i.postimg.cc/rydywLzW/retarded-bender-by-act52-dh91kz1.png') center/contain no-repeat;
    mix-blend-mode:screen;
    -webkit-mask-image:radial-gradient(ellipse at 55% 55%, rgba(0,0,0,1) 55%, rgba(0,0,0,0) 75%);
            mask-image:radial-gradient(ellipse at 55% 55%, rgba(0,0,0,1) 55%, rgba(0,0,0,0) 75%);
  }

  /* header sticky + hamburger */
  header{position:sticky;top:0;z-index:30;background:var(--panel-strong);backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
  .nav{max-width:1200px;margin:0 auto;padding:10px 14px;display:flex;align-items:center;gap:10px;justify-content:space-between}
  .brand{display:flex;align-items:center;gap:10px}
  .brand img.logo{
    width:32px;height:32px;border-radius:50%; /* cercle = pas de carré */
    border:none;box-shadow:0 0 0 2px rgba(255,255,255,.15) inset;
    background:rgba(255,255,255,.06);
  }
  .brand .name{font-weight:700;letter-spacing:.3px}
  .pill{border:1px solid var(--border);background:var(--panel-soft);border-radius:999px;padding:6px 10px;font-size:12px}
  .actions{display:flex;align-items:center;gap:8px}
  .btn{border:1px solid var(--border);background:var(--panel-soft);color:var(--text);padding:8px 12px;border-radius:10px;transition:.2s}
  .btn:hover{background:rgba(255,255,255,.12)}
  .btn-primary{background:linear-gradient(90deg,#22c55e,#16a34a);border-color:transparent}

  /* hamburger */
  .hamburger{display:none;border:1px solid var(--border);background:var(--panel-soft);border-radius:10px;padding:8px 10px}
  @media (max-width:900px){ .hamburger{display:block} .desktop-only{display:none} }

  /* drawer mobile : scrollable + gestures friendly */
  .drawer{
    position:fixed;top:0;right:0;bottom:0;left:auto;
    width:min(92%,380px);
    background:var(--panel-strong);border-left:1px solid var(--border);
    transform:translateX(100%);transition:transform .25s;
    z-index:40;overflow-y:auto;-webkit-overflow-scrolling:touch;
    touch-action:pan-y;overscroll-behavior:contain;
  }
  .drawer.open{transform:none}
  .drawer .wrap{padding:12px}
  .drawer .grp{display:flex;flex-direction:column;gap:8px;margin-bottom:10px}
  .drawer .title{font-weight:600;margin:8px 0 4px 2px;color:#f8fafc}

  /* layout main */
  .container{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:14px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:14px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  section{margin:12px 0}
  .hidden{display:none}

  /* hero */
  .hero{display:grid;gap:14px}
  .hero h2{margin:0 0 6px 0;font-size:28px}
  .hero p{margin:0;color:var(--muted)}
  @media (min-width:900px){ .hero{grid-template-columns:1.25fr .75fr;align-items:center} }

  /* toolbar catalogue */
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}
  .field{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.08)}
  .field input,.field select{all:unset;color:var(--text)}
  .field input::placeholder{color:#cbd5e1}

  /* grid services */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:12px}
  .service{display:flex;flex-direction:column;gap:10px;padding:12px;border-radius:14px;border:1px solid var(--border);background:rgba(2,6,23,.72);transition:.2s}
  .service:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.25)}
  .service h3{margin:0;font-size:15px}
  .row{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
  .qtyInput{all:unset;width:72px;text-align:center;background:rgba(255,255,255,.08);padding:6px;border-radius:8px;border:1px solid var(--border)}

  /* cart */
  .drawer-cart{position:fixed;right:0;top:0;height:100%;width:min(92%,420px);background:var(--panel-strong);border-left:1px solid var(--border);transform:translateX(100%);transition:.25s;z-index:45;padding:14px;overflow:auto}
  .drawer-cart.open{transform:none}
  .line{display:flex;justify-content:space-between;margin:6px 0;gap:8px}
  .divider{height:1px;background:var(--border);margin:10px 0}
  .total{font-size:18px;font-weight:800}

  /* modal */
  .modal{position:fixed;inset:0;background:rgba(2,6,23,.65);display:none;align-items:center;justify-content:center;z-index:60}
  .modal.open{display:flex}
  .modal .card{max-width:520px;width:92%}

  footer{text-align:center;color:var(--muted);padding:30px 10px}

  /* Lang picker */
  .lang-wrap{position:relative}
  .lang-menu{position:absolute;top:110%;right:0;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:6px;display:none;min-width:130px;z-index:50}
  .lang-wrap.open .lang-menu{display:block}
</style>
</head>
<body>
<div class="bg-overlay"></div>
<div class="bg-character" aria-hidden="true"></div>

<header>
  <nav class="nav" aria-label="Navigation principale">
    <div class="brand">
      <img class="logo" src="https://i.postimg.cc/rydywLzW/retarded-bender-by-act52-dh91kz1.png" alt="Logo PowerBots360">
      <span class="name">PowerBots360</span>
      <span class="pill" id="langBadge">FR</span>
    </div>
    <div class="actions desktop-only">
      <a class="btn" data-goto="home">Accueil</a>
      <a class="btn" data-goto="catalogue">Catalogue</a>
      <a class="btn" data-goto="games">Jeux exclusifs</a>
      <a class="btn" data-goto="contact">Contact</a>
      <a class="btn" data-goto="faq">FAQ</a>
      <a class="btn" data-goto="legal">Légal</a>
      <select class="btn" id="currencySel" aria-label="Devise">
        <option value="EUR" selected>€ EUR</option>
        <option value="USD">$ USD</option>
        <option value="GBP">£ GBP</option>
      </select>
      <div class="lang-wrap">
        <button class="btn" id="langBtn">Langue</button>
        <div class="lang-menu" id="langMenu" role="menu">
          <button class="btn" data-lang="fr">Français</button>
          <button class="btn" data-lang="en">English</button>
        </div>
      </div>
      <button class="btn" data-goto="auth" id="loginBtn">Connexion</button>
      <button class="btn btn-primary" id="openCart">Panier (<span id="cartCount">0</span>)</button>
    </div>
    <button class="hamburger" id="openNav" aria-label="Ouvrir le menu">☰</button>
  </nav>
</header>

<!-- Drawer mobile -->
<aside class="drawer" id="drawerNav" aria-label="Menu">
  <div class="nav" style="position:sticky;top:0;background:transparent;border:0">
    <div class="brand">
      <img class="logo" src="https://i.postimg.cc/rydywLzW/retarded-bender-by-act52-dh91kz1.png" alt="Logo">
      <span class="name">PowerBots360</span>
    </div>
    <button class="hamburger" id="closeNav" aria-label="Fermer">✕</button>
  </div>
  <div class="wrap">
    <div class="grp">
      <div class="title">Navigation</div>
      <a class="btn" data-goto="home">Accueil</a>
      <a class="btn" data-goto="catalogue">Catalogue</a>
      <a class="btn" data-goto="games">Jeux exclusifs</a>
      <a class="btn" data-goto="contact">Contact</a>
      <a class="btn" data-goto="faq">FAQ</a>
      <a class="btn" data-goto="legal">Légal</a>
    </div>
    <div class="grp">
      <div class="title">Préférences</div>
      <div class="field"><span>Devise</span>
        <select id="currencySelM">
          <option value="EUR" selected>€ EUR</option>
          <option value="USD">$ USD</option>
          <option value="GBP">£ GBP</option>
        </select>
      </div>
      <div class="field">
        <span>Langue</span>
        <select id="langSelM">
          <option value="fr" selected>Français</option>
          <option value="en">English</option>
        </select>
      </div>
    </div>
    <div class="grp">
      <div class="title">Compte</div>
      <button class="btn" data-goto="auth">Connexion / Inscription</button>
      <button class="btn btn-primary" id="openCartM">Panier (<span id="cartCountM">0</span>)</button>
      <div class="pill" style="margin-top:6px">Statut : <span id="authStateM">invité</span></div>
    </div>
    <div style="height:24vh"></div> <!-- espace pour scroller confort -->
  </div>
</aside>

<main class="container">
  <!-- HERO -->
  <section id="home" class="card">
    <div class="hero">
      <div>
        <h2 id="heroTitle">Des bots fiables pour booster vos réseaux — pro, rapides, transparents.</h2>
        <p id="heroSubtitle">Recherche avancée, 800+ services filtrables, panier sécurisé (PayPal), coupons, multi-devises et support réactif.</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
          <span class="pill">Paiement PayPal</span>
          <span class="pill">800+ services</span>
          <span class="pill">Multi-plateformes</span>
          <span class="pill">Support 24/7</span>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
          <button class="btn btn-primary" data-goto="catalogue">Voir le catalogue</button>
          <button class="btn" data-goto="contact">Parler à un conseiller</button>
        </div>
      </div>
      <div class="card" style="background:rgba(2,6,23,.78)">
        <div class="row"><strong>Créer un compte</strong><span class="pill">Démo locale</span></div>
        <div class="divider"></div>
        <div class="row" style="gap:8px;flex-wrap:wrap">
          <input id="authEmail" class="btn" placeholder="email@exemple.com" style="flex:1;min-width:220px">
          <input id="authPass" class="btn" placeholder="Mot de passe (min 6)" type="password" style="flex:1;min-width:160px">
          <button class="btn" id="doSignup">Inscription</button>
          <button class="btn" id="doSignin">Connexion</button>
          <button class="btn" id="doSignout">Déconnexion</button>
        </div>
        <div id="authState" class="pill" style="margin-top:8px;background:rgba(255,255,255,.1)">Statut : invité</div>
      </div>
    </div>
  </section>

  <!-- CATALOGUE -->
  <section id="catalogue" class="card hidden" aria-label="Catalogue">
    <div class="toolbar">
      <div class="field" style="flex:1"><span>🔎</span><input id="search" placeholder="Rechercher un service (ex : TikTok likes)…"></div>
      <div class="field">
        <span>🏷️</span>
        <select id="platform">
          <option value="all">Toutes plateformes</option>
          <option>TikTok</option><option>Instagram</option><option>YouTube</option>
          <option>Facebook</option><option>Twitter/X</option><option>Snapchat</option>
          <option>Twitch</option><option>Reddit</option><option>LinkedIn</option>
          <option>Telegram</option><option>Spotify</option><option>Discord</option>
          <option>OnlyFans</option><option>MYM</option><option>Kick</option>
        </select>
      </div>
      <div class="field">
        <span>⚙️</span>
        <select id="sort">
          <option value="pop">Populaires</option>
          <option value="priceAsc">Prix ↑</option>
          <option value="priceDesc">Prix ↓</option>
        </select>
      </div>
    </div>

    <div class="card" style="margin-bottom:12px;background:rgba(2,6,23,.78)">
      <div class="row">
        <div style="display:flex;align-items:center;gap:10px">
          <img id="bannerIcon" alt="logo" style="width:28px;height:28px;border-radius:6px;border:1px solid var(--border)">
          <strong id="bannerTitle">Toutes plateformes</strong>
        </div>
        <span class="muted" id="bannerHint">Astuce : filtre par plateforme et utilise le tri.</span>
      </div>
    </div>

    <div class="grid" id="grid"></div>

    <div class="row" style="justify-content:center;margin-top:10px">
      <button class="btn" id="prevPage">← Précédent</button>
      <div class="pill" id="pageInfo">Page 1 / 1</div>
      <button class="btn" id="nextPage">Suivant →</button>
    </div>
  </section>

  <!-- JEUX EXCLUSIFS -->
  <section id="games" class="card hidden" aria-label="Jeux exclusifs">
    <h3 style="margin-top:0">Jeux exclusifs (bientôt)</h3>
    <p class="muted">Accès réservé aux inscrits. Tes créations seront intégrées ici.</p>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="card hidden" aria-label="Contact">
    <h3 style="margin-top:0">Contact</h3>
    <form id="contactForm" class="grid">
      <input class="btn" name="name" placeholder="Nom complet" required>
      <input class="btn" name="email" placeholder="Email" type="email" required>
      <textarea class="btn" name="msg" placeholder="Message" rows="4" required></textarea>
      <button class="btn btn-primary" type="submit">Envoyer</button>
    </form>
    <div id="contactOk" class="pill" style="margin-top:8px;display:none">Merci, message envoyé (simulation).</div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="card hidden" aria-label="FAQ">
    <h3 style="margin-top:0">FAQ & bonnes pratiques</h3>
    <details open><summary>Livraison & délais</summary><p class="muted">La plupart des services démarrent sous 0–30 min. Certains sont progressifs par design.</p></details>
    <details><summary>Paiement</summary><p class="muted">PayPal est accepté via règlement sécurisé. Les montants sont affichés en €/$/£.</p></details>
    <details><summary>Conformité plateformes</summary><p class="muted">Respectez les CGU de chaque plateforme. Utilisez les options “Safe / Graduel”.</p></details>
    <details><summary>Assistance</summary><p class="muted">Support par email 7j/7.</p></details>
  </section>

  <!-- LEGAL -->
  <section id="legal" class="card hidden" aria-label="Légal">
    <h3 style="margin-top:0">Mentions légales & CGV</h3>
    <details open><summary>Mentions légales</summary><p class="muted">PowerBots360 — Contact : support@powerbots360.com — Hébergement : GitHub Pages.</p></details>
    <details><summary>CGU/CGV</summary><p class="muted">Prestations numériques. Pas de garantie de performance. Remboursements avant lancement.</p></details>
    <details><summary>Confidentialité</summary><p class="muted">Cookies techniques uniquement. Aucune revente de données.</p></details>
  </section>

  <!-- AUTH PAGE (démo locale) -->
  <section id="auth" class="card hidden" aria-label="Compte">
    <h3 style="margin-top:0">Connexion / Inscription</h3>
    <div class="grid">
      <div class="card" style="background:rgba(2,6,23,.78)">
        <div class="row"><strong>Espace client</strong><span class="pill">Démo</span></div>
        <div class="divider"></div>
        <div class="row" style="gap:8px;flex-wrap:wrap">
          <input id="authEmail2" class="btn" placeholder="email@exemple.com" style="flex:1;min-width:220px">
          <input id="authPass2" class="btn" placeholder="Mot de passe (min 6)" type="password" style="flex:1;min-width:160px">
          <button class="btn" id="doSignup2">Inscription</button>
          <button class="btn" id="doSignin2">Connexion</button>
          <button class="btn" id="doSignout2">Déconnexion</button>
        </div>
        <div id="authState2" class="pill" style="margin-top:8px;background:rgba(255,255,255,.1)">Statut : invité</div>
      </div>
    </div>
  </section>
</main>

<!-- PANIER -->
<aside id="cart" class="drawer-cart" aria-label="Panier">
  <div class="row"><h3 style="margin:0">Panier</h3><button class="btn" id="closeCart">Fermer</button></div>
  <div class="divider"></div>
  <div id="cartItems"></div>
  <div class="divider"></div>
  <div class="line"><span>Sous-total</span><span id="subTotal">€ 0.00</span></div>
  <div class="line"><span>Remise</span><span id="discount">€ 0.00</span></div>
  <div class="total line"><span>Total</span><span id="grandTotal">€ 0.00</span></div>
  <div class="divider"></div>
  <div class="row"><input id="coupon" class="btn" placeholder="Code promo (WELCOME10 / VIP5)" style="flex:1"><button class="btn" id="applyCoupon">Appliquer</button></div>
  <div class="divider"></div>
  <button class="btn btn-primary" id="checkout">Payer via PayPal</button>
  <div class="muted" style="margin-top:6px">Paiement opéré par PayPal.</div>
</aside>

<!-- MODAL CONFIRM -->
<div class="modal" id="confirmModal" role="dialog" aria-modal="true">
  <div class="card">
    <h3 style="margin:0 0 6px 0">Confirmer la commande</h3>
    <p class="muted">Un nouvel onglet PayPal s’ouvrira avec le montant exact.</p>
    <div class="divider"></div>
    <div class="row">
      <button class="btn" id="cancelConfirm">Annuler</button>
      <button class="btn btn-primary" id="goPay">Payer avec PayPal</button>
    </div>
  </div>
</div>

<footer>
  © <span id="year"></span> PowerBots360 — Tous droits réservés
</footer>

<script>
/* ========= ETAT GLOBAL ========= */
const state = {
  lang:'fr', currency:'EUR', rate:{EUR:1, USD:1.08, GBP:0.85},
  catalog:[], perPage:28, page:1, cart:[], coupon:null, user:null
};
const PAYPAL_ME='https://www.paypal.me/BotMarketPlus?locale.x=fr_FR';

/* ========= NAV ========= */
function show(id){
  document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  drawerNav.classList.remove('open'); // auto-fermeture après choix
}
document.querySelectorAll('[data-goto]').forEach(el=>el.addEventListener('click',()=>show(el.dataset.goto)));

const drawerNav=document.getElementById('drawerNav');
document.getElementById('openNav').onclick=()=>drawerNav.classList.add('open');
document.getElementById('closeNav').onclick=()=>drawerNav.classList.remove('open');

/* Swipe pour fermer le drawer (glisser vers la droite) */
let touchX=null;
drawerNav.addEventListener('touchstart',e=>{touchX=e.touches[0].clientX;},{passive:true});
drawerNav.addEventListener('touchmove',e=>{
  if(touchX===null) return;
  const dx=e.touches[0].clientX - touchX;
  if(dx>60){ drawerNav.classList.remove('open'); touchX=null; }
},{passive:true});
drawerNav.addEventListener('touchend',()=>{touchX=null});

/* ========= LANG ========= */
const i18n={fr:{heroTitle:'Des bots fiables pour booster vos réseaux — pro, rapides, transparents.',
  heroSubtitle:'Recherche avancée, 800+ services filtrables, panier sécurisé (PayPal), coupons, multi-devises et support réactif.',
  payBtn:'Payer via PayPal'},
  en:{heroTitle:'Reliable bots to grow your socials — pro, fast, transparent.',
  heroSubtitle:'Advanced search, 800+ filterable services, secure cart (PayPal), coupons, multi-currency and responsive support.',
  payBtn:'Pay with PayPal'}};
function setLang(l){
  state.lang=l;
  document.getElementById('langBadge').textContent=l.toUpperCase();
  document.getElementById('heroTitle').textContent=i18n[l].heroTitle;
  document.getElementById('heroSubtitle').textContent=i18n[l].heroSubtitle;
  document.getElementById('checkout').textContent=i18n[l].payBtn;
}
document.getElementById('langBtn').onclick=()=>document.querySelector('.lang-wrap').classList.toggle('open');
document.getElementById('langMenu').querySelectorAll('button[data-lang]').forEach(b=>b.onclick=()=>{setLang(b.dataset.lang);document.querySelector('.lang-wrap').classList.remove('open');});
document.getElementById('langSelM').onchange=(e)=>setLang(e.target.value);

/* ========= CURRENCY ========= */
function fmtMoney(v){const c=state.currency;const sym=c==='EUR'?'€':c==='USD'?'$':'£';return `${sym} ${v.toFixed(2)}`;}
function toCurrency(eur){const r=state.rate[state.currency]||1;return eur*r;}
document.getElementById('currencySel').onchange=(e)=>{state.currency=e.target.value;renderGrid();}
document.getElementById('currencySelM').onchange=(e)=>{state.currency=e.target.value;document.getElementById('currencySel').value=state.currency;renderGrid();};

/* ========= BANNIERE ========= */
const ICONS={
  "TikTok":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/tiktok.svg",
  "Instagram":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg",
  "YouTube":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg",
  "Facebook":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg",
  "Twitter/X":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg",
  "Snapchat":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/snapchat.svg",
  "Twitch":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/twitch.svg",
  "Reddit":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/reddit.svg",
  "LinkedIn":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg",
  "Telegram":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/telegram.svg",
  "Spotify":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/spotify.svg",
  "Discord":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/discord.svg",
  "OnlyFans":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/onlyfans.svg",
  "MYM":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/star.svg",
  "Kick":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/kick.svg"
};
function updateBanner(pf){
  document.getElementById('bannerIcon').src = ICONS[pf] || ICONS['TikTok'];
  document.getElementById('bannerTitle').textContent = (pf==='all'?'Toutes plateformes':pf);
  document.getElementById('bannerHint').textContent = (pf==='all'?'Astuce : filtre par plateforme et utilise le tri.':'Choisis un service, règle quantité et ajoute au panier.');
}

/* ========= CATALOGUE (≈800+) ========= */
const PLATFORMS=["TikTok","Instagram","YouTube","Facebook","Twitter/X","Snapchat","Twitch","Reddit","LinkedIn","Telegram","Spotify","Discord","OnlyFans","MYM","Kick"];
const BASE=[{code:"Likes",min:50,max:100000,base:1.7,desc:"Engagement fiable, profils diversifiés."},{code:"Followers",min:100,max:200000,base:2.3,desc:"Croissance progressive, rétention optimisée."},{code:"Views",min:500,max:1000000,base:1.4,desc:"Diffusion large, livraison rapide."},{code:"Comments",min:20,max:10000,base:3.8,desc:"Commentaires naturels, personnalisables."},{code:"Shares",min:50,max:50000,base:1.6,desc:"Amplification organique, diffusion réseau."},{code:"Live Boost",min:20,max:50000,base:2.8,desc:"Audience live, maintien stable."}];
const TIERS=[{tier:"Essentiel",mult:1.00,tag:"Eco"},{tier:"Avancé",mult:1.12,tag:"Safe"},{tier:"Premium",mult:1.25,tag:"Pro"},{tier:"Ultime",mult:1.38,tag:"Premium"}];
const FLAGS=[{label:"🇫🇷 FR"},{label:"🇧🇷 BR"},{label:"🇮🇳 IN"},{label:"🇪🇸 ES"},{label:"🇺🇸 US"},{label:"🇨🇦 CA"},{label:"🇩🇪 DE"},{label:"🇮🇹 IT"},{label:"🇨🇳 CN"},{label:"🇲🇦 MA"},{label:"🇸🇦 SA"},{label:"🇹🇷 TR"}];
const BOTWATCH={"TikTok":"Signalement contenu inapproprié & sécurité créateur.","Instagram":"Analyse spam & nettoyages de faux tags.","YouTube":"Vérif. commentaires toxiques & signalement.","Facebook":"Modération signalements & gestion groupes.","Twitter/X":"Filtrage mentions toxiques & reports.","Snapchat":"Signalement story/spotlight inadapté.","Twitch":"Modération chat & reports automatiques.","Reddit":"Signalements de posts/threads hors-charte.","LinkedIn":"Veille et signalement de spams réseau.","Telegram":"Modération groupes/anti-spam.","Spotify":"Vérif. anomalies d’écoute.","Discord":"Anti-raid & auto-report.","OnlyFans":"Signalements abus & compliance.","MYM":"Contrôle signalements & contenu.","Kick":"Modération chat & reports."};
function buildCatalog(){
  const items=[]; let id=1;
  for(const p of PLATFORMS){
    items.push({id:id++,platform:p,sku:`${p} BotWatch`,title:`${p} — BotWatch (Conformité & Modération)`,desc:BOTWATCH[p]||"Outils de modération & conformité.",speed:"Progressif",refill:false,priceEUR:+(4.5+Math.random()*2).toFixed(2),oldEUR:null,min:1,max:1000,flag:FLAGS[Math.floor(Math.random()*FLAGS.length)].label,tag:"Sécurité",popular:true});
    for(const base of BASE){
      for(const tier of TIERS){
        for(let origin=0; origin<3; origin++){
          const fl=FLAGS[(id+origin)%FLAGS.length].label;
          const price=base.base*tier.mult*(1+(origin*0.06))+(Math.random()*0.4);
          items.push({id:id++,platform:p,sku:`${p}-${base.code}-${tier.tier}`,title:`${p} ${base.code} — ${tier.tier}`,desc:base.desc,speed:["Instant","Rapide","Graduel"][Math.floor(Math.random()*3)],refill:Math.random()<0.6,priceEUR:+price.toFixed(2),oldEUR:Math.random()<0.20?+(price*1.18).toFixed(2):null,min:base.min,max:base.max,flag:fl,tag:tier.tag,popular:Math.random()<0.45});
        }
      }
    }
  }
  state.catalog=items;
}
buildCatalog();

/* ========= RENDER ========= */
const grid=document.getElementById('grid');
const pageInfo=document.getElementById('pageInfo');
const prevPage=document.getElementById('prevPage');
const nextPage=document.getElementById('nextPage');

function filteredList(){
  const q=document.getElementById('search').value.trim().toLowerCase();
  const pf=document.getElementById('platform').value;
  const sort=document.getElementById('sort').value;
  let list=state.catalog.filter(s=>{
    const okP=(pf==='all')||(s.platform===pf);
    const okQ=!q||(s.title.toLowerCase().includes(q)||s.sku.toLowerCase().includes(q)||(s.flag&&s.flag.toLowerCase().includes(q)));
    return okP&&okQ;
  });
  if(sort==='priceAsc') list.sort((a,b)=>a.priceEUR-b.priceEUR);
  else if(sort==='priceDesc') list.sort((a,b)=>b.priceEUR-a.priceEUR);
  else list.sort((a,b)=>(b.popular|0)-(a.popular|0));
  return list;
}
function renderGrid(){
  const list=filteredList();
  const totalPages=Math.max(1,Math.ceil(list.length/state.perPage));
  if(state.page>totalPages) state.page=totalPages;
  const start=(state.page-1)*state.perPage;
  const slice=list.slice(start,start+state.perPage);
  grid.innerHTML=slice.map(renderCard).join('');
  pageInfo.textContent=`Page ${state.page} / ${totalPages}`;
  prevPage.disabled=(state.page<=1);
  nextPage.disabled=(state.page>=totalPages);
  document.getElementById('cartCountM').textContent=document.getElementById('cartCount').textContent;
}
function renderCard(it){
  const price=toCurrency(it.priceEUR);
  const old=it.oldEUR?toCurrency(it.oldEUR):null;
  return `
  <div class="service" data-id="${it.id}">
    <h3 title="${it.sku}">${it.title}</h3>
    <div class="row" style="gap:6px">
      <span class="pill">${it.platform}</span>
      <span class="pill">${it.speed}</span>
      ${it.refill?'<span class="pill">Refill</span>':''}
      ${it.tag?`<span class="pill">${it.tag}</span>`:''}
      ${it.popular?'<span class="pill">Populaire</span>':''}
      ${it.flag?`<span class="pill">${it.flag}</span>`:''}
    </div>
    <p class="muted" style="margin:0">${it.desc}</p>
    <div class="row">
      <div>
        <strong>${fmtMoney(price)}</strong>
        ${old?` <span style="color:#94a3b8;text-decoration:line-through">${fmtMoney(old)}</span>`:''}
      </div>
      <small class="muted">Min ${it.min} / Max ${it.max}</small>
    </div>
    <div class="row">
      <input class="qtyInput" type="number" min="${it.min}" max="${it.max}" step="${Math.ceil(it.min/5)}" value="${it.min}">
      <button class="btn addBtn">Ajouter</button>
      <button class="btn" onclick="openDetails(${it.id})">Détails</button>
    </div>
  </div>`;
}
document.getElementById('search').oninput=()=>{state.page=1;renderGrid();}
document.getElementById('platform').onchange=(e)=>{updateBanner(e.target.value);state.page=1;renderGrid();}
document.getElementById('sort').onchange=()=>renderGrid();
prevPage.onclick=()=>{state.page=Math.max(1,state.page-1);renderGrid();window.scrollTo({top:0,behavior:'smooth'})}
nextPage.onclick=()=>{state.page=state.page+1;renderGrid();window.scrollTo({top:0,behavior:'smooth'})}

/* ========= DETAILS ========= */
function openDetails(id){
  const it=state.catalog.find(x=>x.id===id); if(!it) return;
  alert(`🔍 ${it.title}\n\n• SKU: ${it.sku}\n• Plateforme: ${it.platform}\n• Origine: ${it.flag}\n• Vitesse: ${it.speed}\n• Min/Max: ${it.min}/${it.max}\n\nDescription:\n${it.desc}`);
}

/* ========= PANIER ========= */
const cartDrawer=document.getElementById('cart');
document.getElementById('openCart').onclick=()=>cartDrawer.classList.add('open');
document.getElementById('openCartM').onclick=()=>cartDrawer.classList.add('open');
document.getElementById('closeCart').onclick=()=>cartDrawer.classList.remove('open');

grid.addEventListener('click', (e)=>{
  const btn=e.target.closest('.addBtn'); if(!btn) return;
  const card=e.target.closest('.service'); const id=+card.dataset.id;
  const qty=+card.querySelector('.qtyInput').value;
  const it=state.catalog.find(s=>s.id===id); if(!it) return;
  const q=Math.min(Math.max(qty,it.min),it.max);
  const exist=state.cart.find(c=>c.id===id);
  if(exist) exist.qty+=q; else state.cart.push({id,title:it.title,priceEUR:it.priceEUR,qty:q});
  bumpCart(); renderCart();
});
function bumpCart(){const c=state.cart.reduce((a,b)=>a+b.qty,0);document.getElementById('cartCount').textContent=c;document.getElementById('cartCountM').textContent=c;}
function computeDiscount(subEUR){const code=(state.coupon||'').toUpperCase();if(code==='WELCOME10')return subEUR*0.10;if(code==='VIP5')return subEUR*0.05;return 0;}
function renderCart(){
  const wrap=document.getElementById('cartItems'); wrap.innerHTML='';
  let subEUR=0;
  for(const c of state.cart){
    subEUR+=c.priceEUR*c.qty/1000;
    const line=document.createElement('div'); line.className='line';
    line.innerHTML=`<div><div><strong>${c.title}</strong></div><div class="muted">${c.qty} unités · € ${(c.priceEUR).toFixed(2)}/1000</div></div><button class="btn rm" data-id="${c.id}">✕</button>`;
    wrap.appendChild(line);
  }
  const discount=computeDiscount(subEUR);
  const total=Math.max(0,subEUR-discount);
  const curSub=toCurrency(subEUR), curDis=toCurrency(discount), curTot=toCurrency(total);
  document.getElementById('subTotal').textContent=fmtMoney(curSub);
  document.getElementById('discount').textContent=fmtMoney(curDis);
  document.getElementById('grandTotal').textContent=fmtMoney(curTot);
  wrap.querySelectorAll('.rm').forEach(b=>{
    b.onclick=()=>{ state.cart=state.cart.filter(x=>x.id!==+b.dataset.id); bumpCart(); renderCart(); };
  });
}
document.getElementById('applyCoupon').onclick=()=>{ state.coupon=document.getElementById('coupon').value.trim(); renderCart(); };
document.getElementById('checkout').onclick=()=>{
  if(!state.cart.length){ alert('Panier vide.'); return; }
  document.getElementById('confirmModal').classList.add('open');
};
document.getElementById('cancelConfirm').onclick=()=>document.getElementById('confirmModal').classList.remove('open');
document.getElementById('goPay').onclick=()=>{
  let subEUR=0; for(const c of state.cart) subEUR+=c.priceEUR*c.qty/1000;
  const discount=computeDiscount(subEUR);
  let totalEUR=Math.max(0,subEUR-discount);
  if(state.currency!=='EUR'){ totalEUR=totalEUR/(state.rate[state.currency]||1); }
  const amount=Math.max(1,+totalEUR.toFixed(2));
  window.open(`${PAYPAL_ME}/${amount}`,'_blank');
  document.getElementById('confirmModal').classList.remove('open');
};

/* ========= AUTH DEMO LOCALE ========= */
function setUser(u){
  state.user=u;
  const txt=u?`Connecté : ${u.email}`:'Statut : invité';
  document.getElementById('authState').textContent=txt;
  document.getElementById('authState2').textContent=txt;
  document.getElementById('authStateM').textContent=u?'connecté':'invité';
  document.getElementById('loginBtn').textContent=u?'Mon compte':'Connexion';
}
function saveUser(email){ localStorage.setItem('pb360_user', JSON.stringify({email})); setUser({email}); }
function loadUser(){ const s=localStorage.getItem('pb360_user'); if(s){ try{setUser(JSON.parse(s));}catch{} } }
function clearUser(){ localStorage.removeItem('pb360_user'); setUser(null); }
function bindAuth(prefix){
  const email=document.getElementById(prefix==='1'?'authEmail':'authEmail2');
  const pass=document.getElementById(prefix==='1'?'authPass':'authPass2');
  document.getElementById(prefix==='1'?'doSignup':'doSignup2').onclick=()=>{
    if(email.value && (pass.value||'').length>=6){ saveUser(email.value.trim()); alert('Compte créé (démo locale).'); }
    else alert('Email/mot de passe invalide (min 6).');
  };
  document.getElementById(prefix==='1'?'doSignin':'doSignin2').onclick=()=>{
    const u=localStorage.getItem('pb360_user');
    if(u){ const {email:em}=JSON.parse(u); if(em===email.value.trim() && (pass.value||'').length>=6){ setUser({email:em}); alert('Connecté.'); } else alert('Identifiants incorrects (démo).'); }
    else alert('Aucun compte (démo). Cliquez “Inscription”.');
  };
  document.getElementById(prefix==='1'?'doSignout':'doSignout2').onclick=()=>{ clearUser(); alert('Déconnecté.'); };
}
bindAuth('1'); bindAuth('2'); loadUser();

/* ========= CONTACT (simulation) ========= */
document.getElementById('contactForm').onsubmit=(e)=>{e.preventDefault();document.getElementById('contactOk').style.display='inline-block';e.target.reset();};

/* ========= INIT ========= */
document.getElementById('year').textContent=new Date().getFullYear();
function updateBanner(pf){ const ICONS=window.ICONS||{}; document.getElementById('bannerIcon').src=ICONS[pf]||ICONS['TikTok']; document.getElementById('bannerTitle').textContent=(pf==='all'?'Toutes plateformes':pf); document.getElementById('bannerHint').textContent=(pf==='all'?'Astuce : filtre par plateforme et utilise le tri.':'Choisis un service, règle quantité et ajoute au panier.'); }
updateBanner('all'); renderGrid();

/* ========= ACCESSIBILITÉ ========= */
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape'){ drawerNav.classList.remove('open'); document.getElementById('cart').classList.remove('open'); document.getElementById('confirmModal').classList.remove('open'); document.querySelector('.lang-wrap')?.classList.remove('open'); }});
document.addEventListener('click',(e)=>{ if(!document.querySelector('.lang-wrap')?.contains(e.target)) document.querySelector('.lang-wrap')?.classList.remove('open');});
</script>
</body>
</html>
