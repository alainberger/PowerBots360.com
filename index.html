<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>PowerBots360 — Catalogue & Paiement Crypto</title>
<meta name="theme-color" content="#0f172a"/>

<!-- Police & Icônes -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>

<style>
  :root{
    --bg:#0b1020;
    --card:rgba(255,255,255,.08);
    --text:#e5e7eb;
    --muted:#94a3b8;
    --line:rgba(255,255,255,.14);
    --accent:#22d3ee;
    --success:#22c55e;
    --danger:#ef4444;
  }

  *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
  html,body{height:100%}
  body{
    margin:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    color:var(--text);
    background:var(--bg) url('https://i.postimg.cc/qRzJKc7j/IMG-3273.jpg') center/cover fixed no-repeat;
  }
  a{color:inherit;text-decoration:none}
  button,select,input,textarea{font-family:inherit}

  /* Overlay pour lisibilité */
  .overlay{position:fixed;inset:0;background:linear-gradient(to bottom,rgba(2,6,23,.70),rgba(2,6,23,.25) 35%,rgba(2,6,23,.70));z-index:0}

  /* Conteneur */
  .container{position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:16px}

  /* Cartes + boutons */
  .card{
    background:rgba(13,18,35,.55);backdrop-filter:blur(10px);
    border:1px solid var(--line);border-radius:16px;padding:16px;
    box-shadow:0 10px 30px rgba(0,0,0,.25)
  }
  .btn{
    display:inline-flex;align-items:center;gap:8px;justify-content:center;
    border:1px solid var(--line);background:var(--card);color:var(--text);
    padding:10px 14px;border-radius:12px;cursor:pointer;transition:.2s;
    font-weight:600;line-height:1
  }
  .btn:hover{background:rgba(255,255,255,.12)}
  .btn.primary{border:none;background:linear-gradient(90deg,#22c55e,#16a34a)}
  .btn.warn{border:none;background:linear-gradient(90deg,#ef4444,#b91c1c)}
  .btn.ghost{background:transparent}

  /* Header / Nav */
  header{position:sticky;top:0;z-index:10;background:rgba(10,14,28,.72);backdrop-filter:blur(12px);border-bottom:1px solid var(--line)}
  .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;max-width:1200px;margin:0 auto;padding:10px 16px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{
    width:34px;height:34px;border-radius:50%;
    background:radial-gradient(35% 35% at 30% 30%, #22d3ee, #2563eb 60%, #0ea5e9);
    box-shadow:0 0 20px rgba(56,189,248,.5), inset 0 0 12px rgba(59,130,246,.5);
  }
  .brand h1{font-size:18px;margin:0;letter-spacing:.2px}
  .bar{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .lang-wrap{position:relative}
  .lang-menu{position:absolute;right:0;top:calc(100% + 6px);background:rgba(15,23,42,.96);border:1px solid var(--line);border-radius:12px;overflow:hidden;display:none;min-width:160px}
  .lang-menu.open{display:block}
  .lang-item{padding:10px 12px;display:flex;align-items:center;gap:8px}
  .lang-item:hover{background:rgba(255,255,255,.08)}

  /* Hamburger (mobile) */
  .hamburger{display:none}
  .drawer{
    position:fixed;inset:0 0 0 auto;width:86%;max-width:360px;background:rgba(15,23,42,.97);
    transform:translateX(100%);transition:.25s;z-index:20;border-left:1px solid var(--line);padding:16px
  }
  .drawer.open{transform:none}
  .drawer .list{display:flex;flex-direction:column;gap:10px}
  .spacer{flex:1}

  /* Hero */
  .hero{display:grid;gap:12px}
  .hero h2{margin:0;font-size:26px}
  .hero p{margin:0;color:#cbd5e1}
  .pillbar{display:flex;gap:8px;flex-wrap:wrap}
  .pill{background:rgba(255,255,255,.10);border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px}

  /* Sections */
  section{margin:12px 0}
  .hidden{display:none}

  /* Outils catalogue */
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:12px 0}
  .field{display:flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:var(--card)}
  .field input,.field select{all:unset;color:var(--text)}
  .field input::placeholder{color:#cbd5e1}

  /* Grille */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
  .service{
    display:flex;flex-direction:column;gap:10px;padding:12px;border-radius:14px;
    background:rgba(2,6,23,.55);border:1px solid var(--line);
    transition:.2s
  }
  .service:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.25)}
  .service h3{margin:0;font-size:16px}
  .chip{font-size:11px;padding:4px 8px;border-radius:999px;background:rgba(255,255,255,.10);border:1px solid var(--line)}
  .row{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
  .price{color:#86efac;font-weight:800}
  .old{color:#94a3b8;text-decoration:line-through;margin-left:6px;font-weight:600}
  .qty input{all:unset;width:70px;text-align:center;background:rgba(255,255,255,.08);padding:8px;border-radius:8px;border:1px solid var(--line)}

  /* Pagination */
  .pag{display:flex;gap:6px;align-items:center;justify-content:center;margin:12px 0;flex-wrap:wrap}
  .pag .pbtn{padding:8px 12px;border-radius:10px;border:1px solid var(--line);background:var(--card);cursor:pointer}
  .pag .pbtn.active{background:linear-gradient(90deg,#22d3ee,#2563eb);border:none}

  /* Panier & Modals */
  .drawer-cart{position:fixed;right:0;top:0;height:100%;width:92%;max-width:420px;background:rgba(15,23,42,.96);
    border-left:1px solid var(--line);transform:translateX(100%);transition:.25s;z-index:30;color:var(--text);padding:16px;overflow:auto}
  .drawer-cart.open{transform:none}
  .line{display:flex;justify-content:space-between;gap:10px;margin:6px 0}
  .divider{height:1px;background:var(--line);margin:10px 0}
  .modal{position:fixed;inset:0;background:rgba(2,6,23,.66);display:none;align-items:center;justify-content:center;z-index:40}
  .modal.open{display:flex}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:rgba(15,23,42,.95);border:1px solid var(--line);padding:10px 14px;border-radius:12px;z-index:50;display:none}
  .toast.show{display:block}

  /* Formulaires */
  .form{display:grid;gap:10px}
  .input{padding:12px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.08);color:var(--text)}
  label.small{font-size:12px;color:var(--muted)}

  /* Footer */
  footer{color:#94a3b8;text-align:center;padding:30px 16px}

  /* Responsive */
  @media (min-width:900px){
    .hero{grid-template-columns:1.2fr .8fr;align-items:center}
  }
  @media (max-width:860px){
    .hamburger{display:inline-flex}
    .bar.desktop{display:none}
  }
</style>
</head>
<body>
<div class="overlay" aria-hidden="true"></div>

<header>
  <div class="nav">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1>PowerBots360</h1>
    </div>

    <!-- Barre desktop -->
    <div class="bar desktop" role="navigation" aria-label="Navigation principale">
      <button class="btn ghost" data-goto="home"><i class="fa-solid fa-house"></i> <span data-i18n="nav_home">Accueil</span></button>
      <button class="btn ghost" data-goto="catalogue"><i class="fa-solid fa-grid-2"></i> <span data-i18n="nav_catalog">Catalogue</span></button>
      <button class="btn ghost" data-goto="contact"><i class="fa-solid fa-envelope"></i> <span data-i18n="nav_contact">Contact</span></button>
      <button class="btn ghost" data-goto="faq"><i class="fa-solid fa-circle-question"></i> <span data-i18n="nav_faq">FAQ</span></button>
      <button class="btn ghost" data-goto="legal"><i class="fa-solid fa-scale-balanced"></i> <span data-i18n="nav_legal">Légal</span></button>

      <div class="lang-wrap">
        <button class="btn" id="langBtn"><i class="fa-solid fa-language"></i> <span id="langLabel">FR</span></button>
        <div class="lang-menu" id="langMenu" role="menu">
          <div class="lang-item" data-lang="fr">🇫🇷 Français</div>
          <div class="lang-item" data-lang="en">🇬🇧 English</div>
        </div>
      </div>

      <select class="btn" id="currencySel" aria-label="Devise">
        <option value="EUR" selected>€ EUR</option><option value="USD">$ USD</option><option value="GBP">£ GBP</option>
      </select>
      <button class="btn" id="loginBtn"><i class="fa-regular fa-user"></i> <span data-i18n="nav_login">Connexion</span></button>
      <button class="btn primary" id="openCart"><i class="fa-solid fa-bag-shopping"></i> <span data-i18n="nav_cart">Panier</span> (<span id="cartCount">0</span>)</button>
    </div>

    <!-- Mobile -->
    <button class="btn hamburger" id="openDrawer" aria-label="Ouvrir le menu"><i class="fa-solid fa-bars"></i></button>
  </div>
</header>

<!-- Drawer Mobile -->
<aside class="drawer" id="drawer">
  <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px">
    <strong>Menu</strong>
    <button class="btn" id="closeDrawer"><i class="fa-solid fa-xmark"></i></button>
  </div>
  <div class="list">
    <button class="btn" data-goto="home"><i class="fa-solid fa-house"></i> <span data-i18n="nav_home">Accueil</span></button>
    <button class="btn" data-goto="catalogue"><i class="fa-solid fa-grid-2"></i> <span data-i18n="nav_catalog">Catalogue</span></button>
    <button class="btn" data-goto="contact"><i class="fa-solid fa-envelope"></i> <span data-i18n="nav_contact">Contact</span></button>
    <button class="btn" data-goto="faq"><i class="fa-solid fa-circle-question"></i> <span data-i18n="nav_faq">FAQ</span></button>
    <button class="btn" data-goto="legal"><i class="fa-solid fa-scale-balanced"></i> <span data-i18n="nav_legal">Légal</span></button>
    <div class="spacer"></div>
    <div class="lang-wrap">
      <button class="btn" id="langBtnM"><i class="fa-solid fa-language"></i> <span id="langLabelM">FR</span></button>
      <div class="lang-menu" id="langMenuM">
        <div class="lang-item" data-lang="fr">🇫🇷 Français</div>
        <div class="lang-item" data-lang="en">🇬🇧 English</div>
      </div>
    </div>
    <select class="btn" id="currencySelM" aria-label="Devise mobile">
      <option value="EUR" selected>€ EUR</option><option value="USD">$ USD</option><option value="GBP">£ GBP</option>
    </select>
    <button class="btn" id="loginBtnM"><i class="fa-regular fa-user"></i> <span data-i18n="nav_login">Connexion</span></button>
    <button class="btn primary" id="openCartM"><i class="fa-solid fa-bag-shopping"></i> <span data-i18n="nav_cart">Panier</span> (<span id="cartCountM">0</span>)</button>
  </div>
</aside>

<!-- Panier -->
<aside class="drawer-cart" id="cart">
  <div class="row"><h3 style="margin:0">Panier</h3><button class="btn" id="closeCart"><i class="fa-solid fa-xmark"></i></button></div>
  <div class="divider"></div>
  <div id="cartItems"></div>
  <div class="divider"></div>
  <div class="line"><span data-i18n="subtotal">Sous-total</span><span id="subTotal">€ 0.00</span></div>
  <div class="line"><span data-i18n="discount">Remise</span><span id="discount">€ 0.00</span></div>
  <div class="line"><span data-i18n="currency">Devise</span><span id="currencyView">EUR</span></div>
  <div class="line" style="font-weight:800"><span>Total</span><span id="grandTotal">€ 0.00</span></div>
  <div class="divider"></div>
  <button class="btn primary" id="checkout"><i class="fa-brands fa-bitcoin"></i> <span data-i18n="pay_crypto">Payer en crypto</span></button>
</aside>

<!-- Toast -->
<div id="toast" class="toast">✅ Action réussie</div>

<main class="container">
  <!-- HERO -->
  <section id="home" class="card">
    <div class="hero">
      <div>
        <h2 data-i18n="hero_title">Des bots fiables pour booster vos réseaux — pro, rapides, transparents.</h2>
        <p data-i18n="hero_sub">Recherche avancée, panier sécurisé, paiement crypto — tout en un. Multilingue, multi-devises, support réactif.</p>
        <div class="pillbar">
          <div class="pill">🔒 Paiement crypto</div>
          <div class="pill">⚡ 800+ services</div>
          <div class="pill">🌍 Multi-plateformes</div>
          <div class="pill">🕒 Support 24/7</div>
        </div>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn primary" data-goto="catalogue"><i class="fa-solid fa-magnifying-glass"></i> <span data-i18n="cta_catalog">Voir le catalogue</span></button>
          <button class="btn" data-goto="contact"><i class="fa-solid fa-headset"></i> <span data-i18n="cta_contact">Parler à un conseiller</span></button>
        </div>
      </div>
      <div class="card" style="background:rgba(2,6,23,.55)">
        <div class="row"><strong data-i18n="quick_login">Espace client</strong><span class="muted" data-i18n="quick_login_note">Inscription/connexion locales (démo).</span></div>
        <div class="divider"></div>
        <div class="row" style="gap:8px;flex-wrap:wrap">
          <input id="email" class="input" placeholder="email@exemple.com" style="min-width:220px;flex:1"/>
          <input id="pass" class="input" placeholder="Mot de passe" type="password" style="min-width:160px;flex:1"/>
          <button class="btn" id="signup" data-i18n="signup">Créer</button>
          <button class="btn" id="signin" data-i18n="signin">Se connecter</button>
          <button class="btn warn" id="signout" data-i18n="signout">Se déconnecter</button>
        </div>
        <div id="authState" class="muted" style="margin-top:8px">Statut : invité</div>
      </div>
    </div>
  </section>

  <!-- CATALOGUE -->
  <section id="catalogue" class="card hidden">
    <div class="row" style="align-items:stretch">
      <div class="field" style="flex:1"><i class="fa-solid fa-magnifying-glass"></i><input id="search" placeholder="Rechercher un service (ex : TikTok likes)…"></div>
      <div class="field"><i class="fa-solid fa-tags"></i>
        <select id="platform">
          <option value="all">Toutes plateformes</option>
          <option>TikTok</option><option>Instagram</option><option>YouTube</option>
          <option>Facebook</option><option>Twitter/X</option><option>Snapchat</option>
          <option>Twitch</option><option>Reddit</option><option>LinkedIn</option>
          <option>Telegram</option><option>Spotify</option><option>Discord</option>
        </select>
      </div>
      <div class="field"><i class="fa-solid fa-globe"></i>
        <select id="country">
          <option value="all">Tous pays</option>
          <option value="BR">🇧🇷 Brésil</option>
          <option value="IN">🇮🇳 Inde</option>
          <option value="FR">🇫🇷 France</option>
          <option value="US">🇺🇸 USA</option>
          <option value="DE">🇩🇪 Allemagne</option>
          <option value="CN">🇨🇳 Chine</option>
        </select>
      </div>
      <div class="field"><i class="fa-solid fa-arrow-down-wide-short"></i>
        <select id="sort">
          <option value="pop">Populaires</option>
          <option value="priceAsc">Prix ↑</option>
          <option value="priceDesc">Prix ↓</option>
        </select>
      </div>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>

    <div class="pag" id="pagination"></div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="card hidden">
    <h3>Contact</h3>
    <p class="muted">Besoin d’aide ? Laisse-nous un message — réponse rapide.</p>
    <form id="contactForm" class="form" novalidate>
      <input class="input" name="name" placeholder="Nom complet" required/>
      <input class="input" name="email" placeholder="Email" type="email" required/>
      <textarea class="input" name="msg" placeholder="Message" rows="4" required></textarea>
      <button class="btn primary" type="submit"><i class="fa-solid fa-paper-plane"></i> Envoyer</button>
    </form>
  </section>

  <!-- FAQ -->
  <section id="faq" class="card hidden">
    <h3>FAQ</h3>
    <details><summary>Quels moyens de paiement acceptez-vous ?</summary><p class="muted">Actuellement : crypto (BTC, ETH, USDT). Une fois votre panier validé, vous recevez le montant exact et l’adresse. La commande entre en traitement dès 1–2 confirmations réseau.</p></details>
    <details><summary>Délais de traitement</summary><p class="muted">La plupart des prestations débutent en 0–2h, vitesse réglée selon le service sélectionné (instant, rapide, progressif).</p></details>
    <details><summary>Remboursements</summary><p class="muted">En cas d’échec technique total non imputable à un mauvais lien/commande, un avoir est crédité automatiquement. Voir CGV.</p></details>
    <details><summary>Conformité & usage responsable</summary><p class="muted">Toujours respecter les règles de chaque plateforme et les lois locales. Pas d’usage nuisible.</p></details>
  </section>

  <!-- Légal -->
  <section id="legal" class="card hidden">
    <h3>Mentions légales & Conditions</h3>
    <details open><summary>Mentions légales</summary><p class="muted">PowerBots360 – Contact : support@powerbots360.com</p></details>
    <details><summary>Conditions générales</summary><p class="muted">Prestations numériques, pas de garantie de résultat, délais indicatifs, aucune revente de données. Litiges : juridiction compétente selon siège social.</p></details>
    <details><summary>Confidentialité (RGPD)</summary><p class="muted">Cookies techniques uniquement. Données de contact conservées le temps strictement nécessaire aux échanges.</p></details>
  </section>
</main>

<!-- MODAL DÉTAIL -->
<div class="modal" id="detailModal" role="dialog" aria-modal="true">
  <div class="card" style="max-width:620px;width:92%">
    <div class="row" style="margin-bottom:8px">
      <h3 id="dTitle" style="margin:0"></h3>
      <button class="btn" id="closeDetail"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <p id="dMeta" class="muted" style="margin-top:0"></p>
    <div class="divider"></div>
    <p id="dDesc"></p>
    <div class="row">
      <div class="qty"><label class="small">Quantité</label> <input id="dQty" type="number" min="100" value="100"></div>
      <div><strong id="dPrice" class="price"></strong></div>
      <button class="btn primary" id="dAdd"><i class="fa-solid fa-cart-plus"></i> Ajouter</button>
    </div>
  </div>
</div>

<!-- MODAL PAIEMENT CRYPTO -->
<div class="modal" id="payModal" role="dialog" aria-modal="true">
  <div class="card" style="max-width:560px;width:92%">
    <div class="row" style="margin-bottom:8px">
      <h3 style="margin:0">Paiement crypto</h3>
      <button class="btn" id="closePay"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <p class="muted">Choisissez la crypto et envoyez le montant exact. Traitement dès confirmation réseau.</p>
    <div style="display:grid;gap:8px;grid-template-columns:1fr 1fr 1fr">
      <button class="btn cryptoSel" data-asset="BTC">₿ BTC</button>
      <button class="btn cryptoSel" data-asset="ETH">Ξ ETH</button>
      <button class="btn cryptoSel" data-asset="USDT">₮ USDT (TRC20)</button>
    </div>
    <div class="divider"></div>
    <div id="payInfo">
      <p class="muted">Adresse wallet : <code id="walletAddr">À venir</code></p>
      <div id="qrWrap" class="card" style="text-align:center">
        <canvas id="qr" width="180" height="180" style="width:180px;height:180px"></canvas>
        <div class="muted" style="margin-top:6px">QR affiché à titre de démo</div>
      </div>
    </div>
    <div class="divider"></div>
    <button class="btn primary" id="confirmPay">J’ai payé</button>
  </div>
</div>

<footer>
  <small>© <span id="year"></span> PowerBots360 — Tous droits réservés.</small>
</footer>

<script>
/* ===============================
   ÉTAT GLOBAL / I18N / NAV
================================ */
const state = {
  lang:'fr',
  currency:'EUR',
  rate:{EUR:1, USD:1.08, GBP:0.85},
  user:null,
  catalog:[],
  page:1,
  pageSize:30,
  filters:{q:'', platform:'all', country:'all', sort:'pop'},
  cart:[],
  detail:null
};

const i18n = {
  fr:{
    nav_home:'Accueil',nav_catalog:'Catalogue',nav_contact:'Contact',nav_faq:'FAQ',nav_legal:'Légal',nav_login:'Connexion',nav_cart:'Panier',
    hero_title:'Des bots fiables pour booster vos réseaux — pro, rapides, transparents.',
    hero_sub:'Recherche avancée, panier sécurisé, paiement crypto — tout en un. Multilingue, multi-devises, support réactif.',
    cta_catalog:'Voir le catalogue', cta_contact:'Parler à un conseiller',
    quick_login:'Espace client',quick_login_note:'Inscription/connexion locales (démo).',
    subtotal:'Sous-total',discount:'Remise',currency:'Devise',pay_crypto:'Payer en crypto',
  },
  en:{
    nav_home:'Home',nav_catalog:'Catalog',nav_contact:'Contact',nav_faq:'FAQ',nav_legal:'Legal',nav_login:'Sign in',nav_cart:'Cart',
    hero_title:'Reliable bots to grow your socials — pro, fast, transparent.',
    hero_sub:'Advanced search, secure cart, crypto payments — all-in-one. Multilingual, multicurrency, responsive support.',
    cta_catalog:'Browse catalog', cta_contact:'Contact support',
    quick_login:'Client area',quick_login_note:'Local sign-in (demo).',
    subtotal:'Subtotal',discount:'Discount',currency:'Currency',pay_crypto:'Pay with crypto',
  }
};
function setLang(l){
  state.lang=l;
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const k=el.getAttribute('data-i18n'); el.textContent=i18n[l][k]||el.textContent;
  });
  document.getElementById('langLabel').textContent=l.toUpperCase();
  document.getElementById('langLabelM').textContent=l.toUpperCase();
}
setLang('fr');

function show(id){
  document.querySelectorAll('main section').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  closeDrawer();
}
document.querySelectorAll('[data-goto]').forEach(b=>b.addEventListener('click',()=>show(b.dataset.goto)));

document.getElementById('openDrawer').onclick=()=>document.getElementById('drawer').classList.add('open');
document.getElementById('closeDrawer').onclick=()=>closeDrawer();
function closeDrawer(){document.getElementById('drawer').classList.remove('open');}

/* Lang menu */
const langBtn=document.getElementById('langBtn');
const langMenu=document.getElementById('langMenu');
langBtn.onclick=()=>langMenu.classList.toggle('open');
langMenu.querySelectorAll('.lang-item').forEach(it=>it.onclick=()=>{ setLang(it.dataset.lang); langMenu.classList.remove('open'); });

const langBtnM=document.getElementById('langBtnM');
const langMenuM=document.getElementById('langMenuM');
langBtnM.onclick=()=>langMenuM.classList.toggle('open');
langMenuM.querySelectorAll('.lang-item').forEach(it=>it.onclick=()=>{ setLang(it.dataset.lang); langMenuM.classList.remove('open'); });

/* Devise */
const currencySel=document.getElementById('currencySel');
const currencySelM=document.getElementById('currencySelM');
[currencySel,currencySelM].forEach(sel=>sel.onchange=()=>{ state.currency=sel.value; renderGrid(); renderCart();});

/* ===============================
   GÉNÉRATION CATALOGUE (800)
================================ */
const PLATFORMS=["TikTok","Instagram","YouTube","Facebook","Twitter/X","Snapchat","Twitch","Reddit","LinkedIn","Telegram","Spotify","Discord"];
const TYPES=[
  {code:"likes", label:"Likes", min:100, max:50000, base:1.8, desc:"Apport graduel, profils mélangés."},
  {code:"followers", label:"Abonnés", min:100, max:100000, base:2.2, desc:"Croissance stable, stop si limite atteinte."},
  {code:"views", label:"Vues", min:500, max:1000000, base:1.5, desc:"Démarrage rapide, variations naturelles."},
  {code:"comments", label:"Commentaires", min:20, max:10000, base:3.9, desc:"Textes variés, livraison progressive."},
  {code:"shares", label:"Partages", min:50, max:50000, base:1.7, desc:"Répartition organique."},
  {code:"live", label:"Live boost", min:50, max:50000, base:2.8, desc:"Push en direct, courte durée."},
];
const TIERS=[
  {code:"essential", label:"Essentiel", mult:1.00, note:"Base fiable"},
  {code:"advanced",  label:"Avancé",   mult:1.15, note:"Plus régulier"},
  {code:"premium",   label:"Premium",  mult:1.35, note:"Qualité renforcée"},
  {code:"ultimate",  label:"Ultime",   mult:1.65, note:"Top stabilité"},
];
const COUNTRIES=[
  {cc:"BR", flag:"🇧🇷", label:"Brésil"}, {cc:"IN", flag:"🇮🇳", label:"Inde"}, {cc:"FR", flag:"🇫🇷", label:"France"},
  {cc:"US", flag:"🇺🇸", label:"USA"}, {cc:"DE", flag:"🇩🇪", label:"Allemagne"}, {cc:"CN", flag:"🇨🇳", label:"Chine"},
];

function buildCatalog(){
  const items=[];
  let id=1;
  // on boucle et on s'arrête à 800 pile
  outer: for(const p of PLATFORMS){
    for(const t of TYPES){
      for(const tier of TIERS){
        for(const c of COUNTRIES){
          const base=t.base * tier.mult * (1+Math.random()*0.25);
          items.push({
            id: id++,
            platform: p,
            type: t.label,
            code: `${p}-${t.code}-${tier.code}-${c.cc}`.toLowerCase(),
            country: c.cc, countryFlag:c.flag, countryName:c.label,
            title: `${p} ${t.label} — ${tier.label} ${c.flag}`,
            speed: ["Instant","Rapide","Progressif"][Math.floor(Math.random()*3)],
            refill: Math.random()<.6,
            min: t.min, max: t.max,
            priceEUR: +(base).toFixed(2),
            oldEUR: Math.random()<.22 ? +(base*1.18).toFixed(2) : null,
            popular: Math.random()<.45,
            tier: tier.label,
            desc: `${tier.label} — ${t.desc} (${c.label}).`
          });
          if(items.length>=800) break outer;
        }
      }
    }
  }
  state.catalog=items;
}
buildCatalog();

/* Rendu catalogue */
const grid=document.getElementById('grid');
const pagination=document.getElementById('pagination');

function money(n,cur){
  const sym=cur==='EUR'?'€':cur==='USD'?'$':'£';
  return `${sym} ${(+n).toFixed(2)}`;
}
function priceInCurrency(eur){
  const r=state.rate[state.currency]||1;
  const v= state.currency==='EUR' ? eur : eur*r;
  return money(v,state.currency);
}

function filterList(){
  const q=state.filters.q.toLowerCase();
  return state.catalog.filter(s=>{
    const okP = state.filters.platform==='all' || s.platform===state.filters.platform;
    const okC = state.filters.country==='all' || s.country===state.filters.country;
    const okQ = !q || s.title.toLowerCase().includes(q) || s.code.includes(q);
    return okP && okC && okQ;
  }).sort((a,b)=>{
    if(state.filters.sort==='priceAsc') return a.priceEUR-b.priceEUR;
    if(state.filters.sort==='priceDesc') return b.priceEUR-a.priceEUR;
    return (b.popular|0)-(a.popular|0);
  });
}

function serviceCard(s){
  const price=priceInCurrency(s.priceEUR);
  const old=s.oldEUR? priceInCurrency(s.oldEUR) : null;
  return `
    <div class="service" data-id="${s.id}">
      <h3>${s.title}</h3>
      <div class="row" style="gap:6px;flex-wrap:wrap">
        <span class="chip">${s.platform}</span>
        <span class="chip">${s.countryFlag} ${s.countryName}</span>
        <span class="chip">${s.speed}</span>
        ${s.refill?'<span class="chip">Refill</span>':''}
        <span class="chip">${s.tier}</span>
        ${s.popular?'<span class="chip">Populaire</span>':''}
      </div>
      <div class="row">
        <div><span class="price">${price}</span> ${old?`<span class="old">${old}</span>`:''}</div>
        <small class="muted">Min ${s.min} / Max ${s.max}</small>
      </div>
      <div class="row">
        <div class="qty"><input class="qtyInput" type="number" min="${s.min}" max="${s.max}" value="${s.min}"></div>
        <div style="display:flex;gap:6px">
          <button class="btn" data-act="detail">Détails</button>
          <button class="btn primary" data-act="add">Ajouter</button>
        </div>
      </div>
    </div>
  `;
}

function renderGrid(){
  const list=filterList();
  const total=list.length;
  const pages=Math.max(1, Math.ceil(total/state.pageSize));
  state.page=Math.min(state.page,pages);
  const start=(state.page-1)*state.pageSize, end=start+state.pageSize;
  grid.innerHTML=list.slice(start,end).map(serviceCard).join('');
  renderPag(pages);
}
function renderPag(pages){
  let html= `<button class="pbtn" data-p="-1">« Préc.</button>`;
  for(let i=1;i<=pages;i++){
    const cls = i===state.page?'pbtn active':'pbtn';
    if(i===1 || i===pages || Math.abs(i-state.page)<=2){
      html += `<button class="${cls}" data-p="${i}">${i}</button>`;
    }else if(i===2 && state.page>4 || i===pages-1 && state.page<pages-3){
      html += `<span class="muted">…</span>`;
    }
  }
  html+= `<button class="pbtn" data-p="+1">Suiv. »</button>`;
  pagination.innerHTML=html;
}
pagination.addEventListener('click',(e)=>{
  const b=e.target.closest('button.pbtn'); if(!b) return;
  const v=b.dataset.p;
  if(v==='-1') state.page=Math.max(1,state.page-1);
  else if(v==='+1') state.page=state.page+1;
  else state.page=+v;
  renderGrid();
});

/* Filtres & recherche */
document.getElementById('search').oninput=(e)=>{state.filters.q=e.target.value;state.page=1;renderGrid();}
document.getElementById('platform').onchange=(e)=>{state.filters.platform=e.target.value;state.page=1;renderGrid();}
document.getElementById('country').onchange=(e)=>{state.filters.country=e.target.value;state.page=1;renderGrid();}
document.getElementById('sort').onchange=(e)=>{state.filters.sort=e.target.value;state.page=1;renderGrid();}

/* Ajout panier & détails */
grid.addEventListener('click',(e)=>{
  const card=e.target.closest('.service'); if(!card) return;
  const id=+card.dataset.id;
  const s=state.catalog.find(x=>x.id===id);
  const act=e.target.closest('button')?.dataset.act;
  if(act==='add'){
    const qty=+card.querySelector('.qtyInput').value||s.min;
    addToCart(s, Math.max(s.min, Math.min(qty,s.max)));
  }
  if(act==='detail'){ openDetail(s); }
});

/* ===============================
   PANIER / CHECKOUT CRYPTO
================================ */
const cartEl=document.getElementById('cart');
document.getElementById('openCart').onclick=()=>cartEl.classList.add('open');
document.getElementById('openCartM').onclick=()=>cartEl.classList.add('open');
document.getElementById('closeCart').onclick=()=>cartEl.classList.remove('open');

function addToCart(s,qty){
  const exist=state.cart.find(c=>c.id===s.id);
  if(exist) exist.qty+=qty;
  else state.cart.push({id:s.id,title:s.title,priceEUR:s.priceEUR,qty});
  bumpCart(); renderCart(); toast('Ajouté au panier');
}
function bumpCart(){
  const count=state.cart.reduce((a,b)=>a+b.qty,0);
  document.getElementById('cartCount').textContent=count;
  document.getElementById('cartCountM').textContent=count;
}
function renderCart(){
  const wrap=document.getElementById('cartItems'); wrap.innerHTML='';
  let subEUR=0;
  state.cart.forEach(c=>{
    subEUR += c.priceEUR * c.qty / 1000; // exemple: prix pour 1000 unités
    const line=document.createElement('div'); line.className='line';
    line.innerHTML=`<div><strong>${c.title}</strong><div class="muted">${c.qty} u · ${money(c.priceEUR,'EUR')}/1000</div></div>
    <button class="btn" data-rm="${c.id}">✕</button>`;
    wrap.appendChild(line);
  });
  const cur=state.currency;
  const rate=state.rate[cur]||1;
  const sub = cur==='EUR'? subEUR : subEUR*rate;
  document.getElementById('subTotal').textContent=money(sub,cur);
  document.getElementById('discount').textContent=money(0,cur);
  document.getElementById('grandTotal').textContent=money(sub,cur);
  document.getElementById('currencyView').textContent=cur;

  wrap.querySelectorAll('[data-rm]').forEach(b=>{
    b.onclick=()=>{state.cart=state.cart.filter(x=>x.id!==+b.dataset.rm); bumpCart(); renderCart();}
  });
}
document.getElementById('checkout').onclick=()=>openPay();

function openPay(){
  if(!state.cart.length){ toast('Panier vide'); return; }
  document.getElementById('payModal').classList.add('open');
  drawQR('demo:payment');
}
document.getElementById('closePay').onclick=()=>document.getElementById('payModal').classList.remove('open');
document.querySelectorAll('.cryptoSel').forEach(b=>b.onclick=()=>{
  const asset=b.dataset.asset;
  // Placeholder d’adresses (à remplacer par tes wallets plus tard)
  const addr = asset==='BTC' ? 'bc1q-demo-btc-address'
            : asset==='ETH' ? '0xDEMOETHADDRESS000000000000000000'
            : 'TDEMOUSDTADDRESS000000000000000000';
  document.getElementById('walletAddr').textContent=addr;
  drawQR(`${asset}:${addr}`);
});
document.getElementById('confirmPay').onclick=()=>{
  document.getElementById('payModal').classList.remove('open');
  toast('Merci ! Paiement en vérification réseau.');
};

/* Petit QR “mock” canvas */
function drawQR(text){
  const c=document.getElementById('qr'); const ctx=c.getContext('2d');
  ctx.fillStyle='#0b1226'; ctx.fillRect(0,0,c.width,c.height);
  // grille simple pseudo-QR
  const sz=10;
  for(let y=0;y<c.height;y+=sz){
    for(let x=0;x<c.width;x+=sz){
      if(((x*y+text.length)%7)<3){ ctx.fillStyle='#e5e7eb'; ctx.fillRect(x+1,y+1,sz-2,sz-2); }
    }
  }
}

/* ===============================
   MODAL DÉTAIL
================================ */
const dModal=document.getElementById('detailModal');
const dTitle=document.getElementById('dTitle');
const dMeta=document.getElementById('dMeta');
const dDesc=document.getElementById('dDesc');
const dQty=document.getElementById('dQty');
const dPrice=document.getElementById('dPrice');
const dAdd=document.getElementById('dAdd');

function openDetail(s){
  state.detail=s;
  dTitle.textContent=s.title;
  dMeta.textContent=`${s.platform} • ${s.countryFlag} ${s.countryName} • ${s.speed} • Min ${s.min} / Max ${s.max}`;
  dDesc.textContent = `Qualité ${s.tier}. ${s.desc} Respect des règles de la plateforme.`;
  dQty.min=s.min; dQty.max=s.max; dQty.value=s.min;
  dPrice.textContent=priceInCurrency(s.priceEUR);
  dModal.classList.add('open');
}
document.getElementById('closeDetail').onclick=()=>dModal.classList.remove('open');
dAdd.onclick=()=>{
  if(!state.detail) return;
  const q=+dQty.value||state.detail.min;
  addToCart(state.detail, Math.max(state.detail.min, Math.min(q, state.detail.max)));
  dModal.classList.remove('open');
};

/* ===============================
   AUTH (démo locale)
================================ */
function setUser(u){
  state.user=u;
  document.getElementById('authState').textContent = u ? `Connecté : ${u.email}` : 'Statut : invité';
  const lb = document.querySelectorAll('[data-i18n="nav_login"]');
  lb.forEach(el=>el.textContent = u? (state.lang==='fr'?'Mon compte':'Account'): (state.lang==='fr'?'Connexion':'Sign in'));
}
document.getElementById('signup').onclick=()=>{
  const email=document.getElementById('email').value.trim();
  const pass=document.getElementById('pass').value.trim();
  if(email && pass.length>=6){ localStorage.setItem('pb_user',JSON.stringify({email})); setUser({email}); toast('Compte créé'); }
  else toast('Email/mot de passe invalide');
};
document.getElementById('signin').onclick=()=>{
  const email=document.getElementById('email').value.trim();
  const pass=document.getElementById('pass').value.trim();
  const u=JSON.parse(localStorage.getItem('pb_user')||'null');
  if(u && u.email===email && pass.length>=6){ setUser(u); toast('Connecté'); } else toast('Identifiants incorrects');
};
document.getElementById('signout').onclick=()=>{ localStorage.removeItem('pb_user'); setUser(null); toast('Déconnecté'); };

/* ===============================
   CONTACT
================================ */
document.getElementById('contactForm').addEventListener('submit',(e)=>{
  e.preventDefault(); toast('Message envoyé (démo)'); e.target.reset();
});

/* ===============================
   UTILITAIRES
================================ */
function toast(txt){
  const t=document.getElementById('toast'); t.textContent=txt; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),1800);
}
document.getElementById('year').textContent=new Date().getFullYear();

/* Init */
renderGrid(); renderCart(); setUser(null);
show('home');
</script>
</body>
</html>
