<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PowerBots360 ‚Äî Panel SMM professionnel</title>
  <meta name="description" content="PowerBots360 ‚Äî Panel SMM professionnel : services r√©seaux sociaux, Paiement s√©curis√© (PayPal), multi-langue, actualit√©s, IA d'assistance." />
  <meta name="theme-color" content="#0f172a"/>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Twemoji pour emojis homog√®nes -->
  <script defer src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>

  <style>
    :root{
      --bg:#071027; --panel:#091126; --panel-strong:#06101e; --panel-soft:rgba(255,255,255,.04);
      --border:rgba(255,255,255,.08); --text:#eef2ff; --muted:#9aa6bd; --brand:#22d3ee;
      --accent:#7c3aed; --ok:#16a34a; --warn:#f59e0b; --danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071027 0%,rgba(7,16,39,0.7) 60%), #071027;color:var(--text);}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1200px;margin:0 auto;padding:18px}
    /* Header */
    header{position:sticky;top:0;background:var(--panel-strong);border-bottom:1px solid var(--border);backdrop-filter:blur(8px);z-index:80}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 18px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(90deg,#0ea5e9,#7c3aed);display:grid;place-items:center}
    .logo svg{width:22px;height:22px}
    .brand .title{font-weight:700;letter-spacing:.3px}
    .pill{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--panel-soft);font-size:13px}
    .menu{display:flex;align-items:center;gap:8px}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:var(--panel-soft);cursor:pointer;color:var(--text)}
    .btn:hover{background:rgba(255,255,255,.06)}
    .btn-primary{background:linear-gradient(90deg,#2563eb,#7c3aed);border:none}
    .hamburger{display:none}
    @media(max-width:980px){ .hamburger{display:block} .desktop-only{display:none} }
    /* drawer */
    .drawer{position:fixed;top:0;right:0;bottom:0;width:min(92%,380px);background:var(--panel-strong);border-left:1px solid var(--border);transform:translateX(100%);transition:transform .25s;z-index:90;padding:12px;overflow:auto}
    .drawer.open{transform:none}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:14px;box-shadow:var(--shadow)}
    .hero{display:grid;gap:16px;padding:18px 0}
    @media(min-width:1000px){ .hero{grid-template-columns:1.2fr .8fr;align-items:center} }
    .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:12px 0}
    .field{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.03)}
    .field input,.field select{all:unset;color:var(--text)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .service{display:flex;flex-direction:column;gap:8px;padding:12px;border-radius:12px;border:1px solid var(--border);background:linear-gradient(180deg,rgba(255,255,255,.01),transparent)}
    .service h3{margin:0;font-size:15px;display:flex;gap:8px;align-items:center}
    .ico{width:20px;height:20px}
    .qty{width:90px;padding:6px;border-radius:8px;background:rgba(255,255,255,.02);border:1px solid var(--border);text-align:center}
    .muted{color:var(--muted);font-size:13px}
    .divider{height:1px;background:var(--border);margin:10px 0}
    .drawer-cart{position:fixed;right:0;top:0;height:100%;width:min(92%,420px);background:var(--panel-strong);border-left:1px solid var(--border);transform:translateX(100%);transition:.25s;z-index:95;padding:14px;overflow:auto}
    .drawer-cart.open{transform:none}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.6);z-index:100}
    .modal.open{display:flex}
    /* news */
    .news-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .news-card{border:1px solid var(--border);border-radius:12px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,.01),transparent)}
    .news-card img{width:100%;height:140px;object-fit:cover}
    .news-pad{padding:12px}
    /* chat */
    .chat-launch{position:fixed;right:18px;bottom:18px;z-index:200}
    .chat-btn{padding:12px;border-radius:999px;background:linear-gradient(90deg,#22d3ee,#7c3aed);border:none;box-shadow:0 10px 30px rgba(0,0,0,.4);cursor:pointer}
    .chat-panel{position:fixed;right:18px;bottom:80px;width:360px;height:560px;background:var(--panel-strong);border:1px solid var(--border);border-radius:12px;display:none;flex-direction:column;overflow:hidden;z-index:200}
    .chat-panel.open{display:flex}
    .chat-head{padding:10px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
    .chat-body{padding:10px;overflow:auto;flex:1;display:flex;flex-direction:column;gap:8px}
    .chat-foot{padding:10px;border-top:1px solid var(--border);display:flex;gap:8px}
    .chat-input{flex:1;padding:10px;border-radius:10px;border:1px solid var(--border);background:rgba(255,255,255,.02);color:var(--text)}
    .chat-msg{padding:10px;border-radius:10px;border:1px solid var(--border);max-width:85%}
    .chat-msg.ai{align-self:flex-start;background:rgba(34,211,238,.06);border-color:rgba(34,211,238,.18)}
    .chat-msg.user{align-self:flex-end;background:rgba(255,255,255,.03)}
    footer{padding:20px;text-align:center;color:var(--muted)}
    /* small */
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <div class="nav container" role="navigation" aria-label="navigation principale">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <!-- simple logo svg -->
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L15.3 8.7L22 10.2L17 15L18.4 22L12 18.7L5.6 22L7 15L2 10.2L8.7 8.7L12 2Z" fill="#ffffff"/></svg>
        </div>
        <div>
          <div class="title">PowerBots360</div>
          <div class="small">Panel SMM professionnel</div>
        </div>
      </div>

      <div class="menu desktop-only" role="menubar" aria-label="menu principal">
        <button class="btn" id="btnCatalogue">Catalogue ‚ñæ</button>
        <button class="btn" id="btnNews">Actualit√©s</button>
        <button class="btn" id="btnFAQ">Bonnes pratiques</button>
        <button class="btn" id="btnLegal">Juridique</button>
        <div style="display:inline-flex;align-items:center;gap:8px;margin-left:8px">
          <div class="pill">üîí SSL</div>
          <div class="pill" id="langBadge">FR</div>
          <button class="btn btn-primary" id="openCart">Panier (<span id="cartCount">0</span>)</button>
        </div>
      </div>

      <button class="hamburger" id="openNav" aria-label="ouvrir le menu">‚ò∞</button>
    </div>
  </header>

  <!-- mobile drawer -->
  <aside id="drawer" class="drawer" aria-hidden="true">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <strong>Menu</strong><button class="btn" id="closeDrawer">‚úï</button>
    </div>
    <div class="divider"></div>
    <nav style="display:flex;flex-direction:column;gap:8px">
      <a class="btn" href="#catalogue" id="navCatalog">Catalogue</a>
      <a class="btn" href="#news" id="navNews">Actualit√©s</a>
      <a class="btn" href="#faq" id="navFaq">Bonnes pratiques</a>
      <a class="btn" href="#legal" id="navLegal">Juridique</a>
      <button class="btn" id="openCartM">Panier</button>
    </nav>
  </aside>

  <main class="container" id="main">
    <!-- HERO -->
    <section class="card hero" aria-label="accueil">
      <div>
        <h1 id="heroTitle">Panel SMM professionnel ‚Äî rapide, fiable, transparent.</h1>
        <p class="muted" id="heroSubtitle">Services v√©rifi√©s, checkout s√©curis√©, multi-langue instant, actualit√©s int√©gr√©es, assistant IA.</p>

        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <div class="pill"><img src="https://www.paypalobjects.com/webstatic/icon/pp258.png" alt="" width="18" style="vertical-align:middle"> PayPal disponible</div>
          <div class="pill">üîí Carte bancaire ‚Äî Prochainement</div>
          <div class="pill">üîí Cryptomonnaies ‚Äî Prochainement</div>
        </div>

        <div class="toolbar" style="margin-top:14px">
          <div class="field" style="flex:1">
            <span>üîé</span>
            <input id="search" placeholder="Tapez une lettre (ex : T) ou un service (ex : Followers)" aria-label="recherche">
          </div>
          <div class="field">
            <span>üè∑Ô∏è</span>
            <select id="platform">
              <option value="">Toutes plateformes</option>
              <option>TikTok</option><option>Instagram</option><option>YouTube</option>
              <option>Facebook</option><option>Twitter/X</option><option>Snapchat</option>
              <option>Twitch</option><option>Reddit</option><option>LinkedIn</option>
              <option>Telegram</option><option>Spotify</option><option>Discord</option>
              <option>OnlyFans</option><option>MYM</option><option>Kik</option>
            </select>
          </div>
          <div class="field">
            <span>‚öôÔ∏è</span>
            <select id="sort">
              <option value="alpha">A ‚Üí Z</option>
              <option value="pop">Populaires</option>
              <option value="priceAsc">Prix ‚Üë</option>
              <option value="priceDesc">Prix ‚Üì</option>
            </select>
          </div>
        </div>
      </div>

      <div class="card" style="background:linear-gradient(180deg,rgba(255,255,255,.01),transparent)">
        <strong>Raccourcis</strong>
        <div class="divider"></div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn" id="shortCatalog">Voir le catalogue</button>
          <button class="btn" id="shortNews">Actualit√©s</button>
          <button class="btn" id="shortFaq">Bonnes pratiques</button>
        </div>
        <div class="divider"></div>
        <div class="muted small">Support r√©actif ‚Ä¢ SSL ‚Ä¢ Conformit√©</div>
      </div>
    </section>

    <!-- CATALOGUE -->
    <section id="catalogue" class="card" aria-label="catalogue" style="margin-top:14px">
      <div class="card" style="margin-bottom:12px;background:linear-gradient(180deg,rgba(255,255,255,.02),transparent)">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div style="display:flex;align-items:center;gap:10px">
            <img id="bannerIcon" src="" alt="" class="ico" style="display:none">
            <strong id="bannerTitle">Catalogue professionnel</strong>
          </div>
          <div class="muted" id="bannerHint">Astuce : tapez une lettre (ex : T) pour lister rapidement.</div>
        </div>
      </div>

      <div id="grid" class="grid" aria-live="polite" style="display:none"></div>
      <div id="emptyHint" class="muted" style="text-align:center;padding:18px">Aucune recherche en cours ‚Äî tapez une lettre ou s√©lectionnez une plateforme pour voir les services.</div>

      <div style="display:flex;justify-content:center;gap:8px;margin-top:12px">
        <button class="btn" id="prevPage">‚Üê Pr√©c√©dent</button>
        <div class="pill" id="pageInfo">Page 1 / 1</div>
        <button class="btn" id="nextPage">Suivant ‚Üí</button>
      </div>
    </section>

    <!-- ACTUALITES -->
    <section id="news" class="card" aria-label="actualit√©s" style="margin-top:14px">
      <h3 style="margin:0 0 8px 0">Actualit√©s & mises √† jour</h3>
      <div id="newsGrid" class="news-grid"></div>
    </section>

    <!-- FAQ/Pratiques -->
    <section id="faq" class="card" style="margin-top:14px">
      <h3>Bonnes pratiques</h3>
      <details open><summary>Livraison & d√©lais</summary><p class="muted">La plupart des services d√©marrent sous 0‚Äì30 min. Certains services sont progressifs.</p></details>
      <details><summary>Paiements</summary><p class="muted">PayPal en live via Checkout. Cartes & cryptos : int√©gration progressive (s√©curis√©e).</p></details>
      <details><summary>Conformit√©</summary><p class="muted">Respectez toujours les CGU des plateformes. Pr√©f√©rez une mont√©e graduelle pour √©viter d√©tections.</p></details>
    </section>

    <!-- LEGAL -->
    <section id="legal" class="card" style="margin-top:14px">
      <h3>Mentions l√©gales & CGV</h3>
      <details open><summary>Mentions l√©gales</summary><p class="muted">PowerBots360 ‚Äî Si√®ge : 10 rue de l'Innovation ‚Äî Contact : support@powerbots360.com ‚Äî H√©bergement : OVHcloud.</p></details>
      <details><summary>CGV</summary><p class="muted">Prestations num√©riques. Remboursements possibles avant lancement des services.</p></details>
    </section>
  </main>

  <!-- CART DRAWER -->
  <aside id="cart" class="drawer-cart" aria-hidden="true">
    <div style="display:flex;align-items:center;justify-content:space-between">
      <strong>Panier</strong>
      <button class="btn" id="closeCart">‚úï</button>
    </div>
    <div class="divider"></div>
    <div id="cartItems"></div>
    <div class="divider"></div>
    <div style="display:flex;justify-content:space-between">
      <div class="muted">Sous-total</div><div id="subTotal">‚Ç¨ 0.00</div>
    </div>
    <div style="display:flex;justify-content:space-between">
      <div class="muted">Remise</div><div id="discount">‚Ç¨ 0.00</div>
    </div>
    <div style="display:flex;justify-content:space-between;font-weight:700;margin-top:8px">
      <div>Total</div><div id="grandTotal">‚Ç¨ 0.00</div>
    </div>
    <div class="divider"></div>

    <!-- PayPal container (Smart Buttons) -->
    <div id="paypal-container"></div>

    <div class="divider"></div>
    <div class="pill small">üîí Cartes bancaires (Visa/Mastercard/Amex) ‚Äî Prochainement</div>
    <div class="pill small" style="margin-top:8px">üîí Cryptomonnaies ‚Äî Prochainement</div>
    <div class="muted small" style="margin-top:8px">Minimum d'achat : <strong>10 ‚Ç¨</strong> (par commande).</div>
  </aside>

  <!-- CONFIRM MODAL -->
  <div id="confirmModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="card">
      <h3>Confirmer la commande</h3>
      <p class="muted">Un checkout PayPal s'ouvrira pour le montant exact.</p>
      <div id="orderSummary" class="pill" style="margin:8px 0"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" id="cancelConfirm">Annuler</button>
        <button class="btn btn-primary" id="goPay">Payer</button>
      </div>
    </div>
  </div>

  <!-- DETAILS MODAL -->
  <div id="detailsModal" class="modal" aria-hidden="true">
    <div class="card" style="max-width:640px;width:92%">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="dTitle">D√©tails</h3>
        <button class="btn" id="closeDetails">‚úï</button>
      </div>
      <div class="divider"></div>
      <div id="dBody" class="muted"></div>
    </div>
  </div>

  <!-- CHAT WIDGET -->
  <div class="chat-launch">
    <button class="chat-btn" id="openChat" title="Parler √† PowerBot AI">üí¨</button>
  </div>
  <div class="chat-panel" id="chatPanel" aria-hidden="true">
    <div class="chat-head">
      <strong>PowerBot AI</strong>
      <button class="btn" id="closeChat">‚úï</button>
    </div>
    <div class="chat-body" id="chatBody">
      <div class="chat-msg ai">Bonjour üëã Je suis PowerBot AI, votre assistant. Posez une question.</div>
    </div>
    <div class="chat-foot">
      <input id="chatInput" class="chat-input" placeholder="√âcrivez votre message‚Ä¶ (Entr√©e pour envoyer)" />
      <button class="btn btn-primary" id="chatSend">Envoyer</button>
    </div>
  </div>

  <footer>
    ¬© <span id="year"></span> PowerBots360 ‚Äî Tous droits r√©serv√©s ‚Ä¢ <span class="small">S√©curit√© : SSL</span>
  </footer>

  <!-- PayPal SDK (remplacez par votre client ID live) -->
  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_LIVE_CLIENT_ID&currency=EUR" async></script>

  <script>
    /**************************************************************************
     * CONFIG
     * - Remplacez YOUR_PAYPAL_LIVE_CLIENT_ID par votre client-id PayPal.
     * - Configurez un endpoint backend pour /api/ai/chat (proxifier OpenAI).
     * - Configurez /api/news si vous voulez remplacer les news demo par du live.
     **************************************************************************/
    const CONFIG = {
      CHAT_API_ENDPOINT: '/api/ai/chat', // proxy backend -> OpenAI (NE PAS mettre la cl√© ici)
      NEWS_API_ENDPOINT: '/api/news',    // optional proxy backend for real news
      MIN_ORDER_EUR: 10,
      SUPPORTED_CRYPTO: ["BTC","ETH","USDT","USDC","LTC","BCH","BNB","ADA","SOL","MATIC","TRX","DOGE","XRP"],
      LANGUAGES: ['fr','en','es','pt','it','de']
    };

    // Small utility
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    function toast(msg){ const t = document.createElement('div'); t.className='pill'; t.style.position='fixed'; t.style.left='50%'; t.style.bottom='18px'; t.style.transform='translateX(-50%)'; t.style.zIndex=999; t.innerHTML = msg; document.body.appendChild(t); setTimeout(()=>t.remove(),2400); twemoji.parse(t); }
    function fmtEUR(n){ return '‚Ç¨ ' + Number(n).toFixed(2); }
    let state = { lang:'fr', catalog:[], page:1, perPage:20, cart:[] };

    /**********************
     * I18N (simple)
     **********************/
    const I18N = {
      fr: { emptyHint:'Aucune recherche en cours ‚Äî tapez une lettre ou s√©lectionnez une plateforme.', payNow:'Payer avec PayPal', chatPlaceholder:'√âcrivez votre message‚Ä¶' },
      en: { emptyHint:'No search yet ‚Äî type a letter or select a platform.', payNow:'Pay with PayPal', chatPlaceholder:'Write your message‚Ä¶' },
      es: { emptyHint:'Sin b√∫squeda ‚Äî escribe una letra o selecciona una plataforma.', payNow:'Pagar con PayPal', chatPlaceholder:'Escribe tu mensaje‚Ä¶' },
      pt: { emptyHint:'Sem pesquisa ‚Äî digite uma letra ou selecione uma plataforma.', payNow:'Pagar com PayPal', chatPlaceholder:'Escreva sua mensagem‚Ä¶' },
      it: { emptyHint:'Nessuna ricerca ‚Äî digita una lettera o seleziona una piattaforma.', payNow:'Paga con PayPal', chatPlaceholder:'Scrivi il tuo messaggio‚Ä¶' },
      de: { emptyHint:'Keine Suche ‚Äî tippe einen Buchstaben oder w√§hle eine Plattform.', payNow:'Mit PayPal zahlen', chatPlaceholder:'Schreiben Sie Ihre Nachricht‚Ä¶' }
    };
    function setLang(l){ if(!CONFIG.LANGUAGES.includes(l)) l='fr'; state.lang = l; document.getElementById('langBadge').textContent = l.toUpperCase(); document.getElementById('emptyHint').textContent = I18N[l].emptyHint; $('#chatInput').placeholder = I18N[l].chatPlaceholder; }

    /**********************
     * FALLBACK CATALOG (demo)
     **********************/
    const CAPABILITIES = {
      "TikTok":["Likes","Followers","Views","Comments","Shares","Live Boost"],
      "Instagram":["Likes","Followers","Views","Comments","Shares"],
      "YouTube":["Views","Comments","Shares"],
      "Facebook":["Likes","Followers","Views","Comments","Shares"],
      "Twitter/X":["Likes","Followers","Views","Comments","Shares"],
      "Snapchat":["Views","Shares"],
      "Twitch":["Followers","Views","Live Boost"],
      "Reddit":["Comments","Shares","Views"],
      "LinkedIn":["Followers","Views","Comments","Shares"],
      "Telegram":["Followers","Views","Comments","Shares"],
      "Spotify":["Views","Followers"],
      "Discord":["Followers","Views"],
      "OnlyFans":["Followers","Views","Comments"],
      "MYM":["Followers","Views","Comments"],
      "Kik":["Followers","Views","Comments"]
    };
    function buildDemoCatalog(){
      const base = [
        {code:"Likes",min:50,max:100000,base:1.7,desc:"Engagement fiable, profils diversifi√©s."},
        {code:"Followers",min:100,max:200000,base:2.3,desc:"Croissance progressive, r√©tention optimis√©e."},
        {code:"Views",min:500,max:1000000,base:1.4,desc:"Diffusion large, livraison rapide."},
        {code:"Comments",min:20,max:10000,base:3.8,desc:"Commentaires naturels, personnalisables."},
        {code:"Shares",min:50,max:50000,base:1.6,desc:"Amplification organique, diffusion r√©seau."},
        {code:"Live Boost",min:20,max:50000,base:2.8,desc:"Audience live, maintien stable."}
      ];
      let id=1; const items=[];
      for(const p of Object.keys(CAPABILITIES)){
        for(const b of base){
          if(!CAPABILITIES[p].includes(b.code)) continue;
          const price = +(b.base + (Math.random()*0.6)).toFixed(2);
          items.push({
            id:id++,
            platform:p,
            title:`${p} ${b.code}`,
            sku:`${p}-${b.code}`,
            desc:b.desc,
            priceEUR:price,
            min:b.min,
            max:b.max,
            speed:["Instant","Rapide","Graduel"][Math.floor(Math.random()*3)],
            tag: ["Eco","Safe","Pro"][Math.floor(Math.random()*3)]
          });
        }
      }
      items.sort((a,b)=>a.title.localeCompare(b.title,'fr',{sensitivity:'base'}));
      return items;
    }

    /**********************
     * Grid rendering & search behavior
     * - grid hidden when no search and platform empty
     **********************/
    function filteredList(){
      const q = ($('#search').value||'').trim().toLowerCase();
      const pf = $('#platform').value || '';
      let list = state.catalog.filter(s=>{
        const okP = !pf || s.platform === pf;
        const okQ = !q || s.title.toLowerCase().includes(q) || s.platform.toLowerCase().startsWith(q) || s.sku?.toLowerCase().includes(q);
        return okP && okQ;
      });
      const sort = $('#sort').value;
      if(sort === 'priceAsc') list.sort((a,b)=>a.priceEUR-b.priceEUR);
      else if(sort === 'priceDesc') list.sort((a,b)=>b.priceEUR-a.priceEUR);
      else if(sort === 'alpha') list.sort((a,b)=>a.title.localeCompare(b.title,'fr',{sensitivity:'base'}));
      return list;
    }

    function renderGrid(){
      const q = ($('#search').value||'').trim();
      const pf = $('#platform').value || '';
      const grid = $('#grid');
      // hide grid if no query and no platform
      if(!q && !pf){ grid.style.display = 'none'; $('#emptyHint').style.display = 'block'; return; }
      $('#emptyHint').style.display = 'none'; grid.style.display = 'grid';
      const list = filteredList();
      if(!list.length){ grid.innerHTML = '<div class="muted" style="grid-column:1/-1;text-align:center">Aucun service trouv√©</div>'; return; }
      const page = state.page || 1;
      const per = state.perPage || 20;
      const totalPages = Math.max(1, Math.ceil(list.length/per));
      if(page > totalPages) state.page = totalPages;
      const slice = list.slice((state.page-1)*per, (state.page-1)*per + per);
      grid.innerHTML = slice.map(it => `
        <div class="service" data-id="${it.id}">
          <h3><img class="ico" src="${brandIcon(it.platform)}" alt="${it.platform}" onerror="this.style.display='none'"> ${it.title}</h3>
          <div class="muted">${it.desc}</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
            <div><strong>${fmtEUR(toCurrency(it.priceEUR))}</strong> <span class="muted">/ 1000</span></div>
            <div class="muted">Min ${it.min} ‚Ä¢ Max ${it.max}</div>
          </div>
          <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
            <input class="qty" type="number" min="${it.min}" max="${it.max}" value="${it.min}" aria-label="Quantit√©">
            <button class="btn" data-action="add">Ajouter</button>
            <button class="btn" data-action="details">D√©tails</button>
          </div>
        </div>
      `).join('');
      $('#pageInfo').textContent = `Page ${state.page} / ${totalPages}`;
      twemoji.parse(document.body);
    }

    function brandIcon(platform){
      // simple-icons CDN approximations
      const map = {
        "TikTok":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/tiktok.svg",
        "Instagram":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg",
        "YouTube":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/youtube.svg",
        "Facebook":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg",
        "Twitter/X":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/x.svg",
        "Snapchat":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/snapchat.svg",
        "Twitch":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/twitch.svg",
        "Reddit":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/reddit.svg",
        "LinkedIn":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/linkedin.svg",
        "Telegram":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/telegram.svg",
        "Spotify":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/spotify.svg",
        "Discord":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/discord.svg",
        "OnlyFans":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/onlyfans.svg",
        "MYM":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/star.svg",
        "Kik":"https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/kick.svg"
      };
      return map[platform]||map['TikTok'];
    }

    function toCurrency(eur){ const rate = 1; return eur * rate; } // currently EUR only; hook later for multi-currency

    /**********************
     * CART LOGIC
     **********************/
    function bumpCartCount(){ $('#cartCount').textContent = state.cart.reduce((s,i)=>s+i.qty,0); }
    function addToCart(itemId, qty){
      const it = state.catalog.find(x=>x.id==itemId);
      if(!it) return;
      const amountEUR = it.priceEUR * qty / 1000; // priceEUR is per 1000 units
      // Enforce minimum purchase
      if(amountEUR < CONFIG.MIN_ORDER_EUR){
        toast(`Montant minimum d'achat : ${fmtEUR(CONFIG.MIN_ORDER_EUR)}. Ajoutez plus d'unit√©s.`);
        return false;
      }
      const exist = state.cart.find(c=>c.id==itemId);
      if(exist) exist.qty += qty;
      else state.cart.push({ id:itemId, title: it.title, priceEUR: it.priceEUR, qty });
      renderCart();
      bumpCartCount();
      return true;
    }
    function renderCart(){
      const wrap = $('#cartItems'); wrap.innerHTML = '';
      let subEUR = 0;
      for(const c of state.cart){
        const it = state.catalog.find(s=>s.id==c.id);
        const line = document.createElement('div');
        line.style.display = 'flex'; line.style.justifyContent='space-between'; line.style.alignItems='center'; line.style.margin='6px 0';
        const left = document.createElement('div'); left.innerHTML = `<div><strong>${c.title}</strong></div><div class="muted">${c.qty} unit√©s ¬∑ ‚Ç¨ ${(c.priceEUR).toFixed(2)}/1000</div>`;
        const btn = document.createElement('button'); btn.className='btn'; btn.textContent='‚úï'; btn.onclick = ()=>{ state.cart = state.cart.filter(x=>x.id!==c.id); renderCart(); bumpCartCount(); };
        line.appendChild(left); line.appendChild(btn);
        wrap.appendChild(line);
        subEUR += c.priceEUR * c.qty / 1000;
      }
      $('#subTotal').textContent = fmtEUR(subEUR);
      $('#discount').textContent = fmtEUR(0);
      $('#grandTotal').textContent = fmtEUR(subEUR);
      // mount paypal with amount check
      mountPayPal(); // re-mount with updated cart
    }

    /**********************
     * PAYPAL MOUNT (Smart Buttons)
     * - Ensure min order of 10 EUR
     **********************/
    function mountPayPal(){
      const container = document.getElementById('paypal-container');
      if(!container) return;
      container.innerHTML = '';
      if(typeof paypal === 'undefined'){ container.innerHTML = '<div class="muted small">PayPal SDK non charg√©.</div>'; return; }
      const subEUR = state.cart.reduce((s,c)=>s + c.priceEUR * c.qty / 1000, 0);
      const amount = Math.max(CONFIG.MIN_ORDER_EUR, Number(subEUR.toFixed(2)));
      paypal.Buttons({
        style: { layout:'vertical', color:'blue', shape:'rect', label:'paypal' },
        createOrder: function(data, actions){
          return actions.order.create({
            purchase_units: [{ amount: { value: amount.toFixed(2), currency_code: 'EUR' } }]
          });
        },
        onApprove: function(data, actions){
          return actions.order.capture().then(function(details){
            toast('Paiement confirm√© ‚úÖ');
            state.cart = []; renderCart(); bumpCartCount();
          });
        },
        onError: function(err){
          console.error('PayPal error', err); toast('Erreur PayPal');
        }
      }).render('#paypal-container');
    }

    /**********************
     * EVENTS: clicks, pagination, search
     **********************/
    $('#openNav').onclick = ()=>{ $('#drawer').classList.add('open'); };
    $('#closeDrawer').onclick = ()=>{ $('#drawer').classList.remove('open'); };
    $('#openCart').onclick = ()=>{ $('#cart').classList.add('open'); $('#cart').setAttribute('aria-hidden','false'); };
    $('#openCartM')?.addEventListener('click', ()=>{ $('#cart').classList.add('open'); });
    $('#closeCart').onclick = ()=>{ $('#cart').classList.remove('open'); $('#cart').setAttribute('aria-hidden','true'); };
    $('#shortCatalog').onclick = ()=>{ document.getElementById('catalogue').scrollIntoView({behavior:'smooth'}); $('#search').focus(); };
    $('#shortNews').onclick = ()=>{ document.getElementById('news').scrollIntoView({behavior:'smooth'}); };
    $('#shortFaq').onclick = ()=>{ document.getElementById('faq').scrollIntoView({behavior:'smooth'}); };

    $('#prevPage').onclick = ()=>{ state.page = Math.max(1, state.page-1); renderGrid(); };
    $('#nextPage').onclick = ()=>{ state.page++; renderGrid(); };

    // grid click (delegation)
    document.addEventListener('click', (e)=>{
      const btn = e.target;
      if(btn.matches('.service [data-action="add"]')){
        const card = btn.closest('.service');
        const id = Number(card.dataset.id);
        const qty = Number(card.querySelector('.qty').value) || 0;
        if(qty <= 0){ toast('Quantit√© invalide'); return; }
        addToCart(id, qty);
      } else if(btn.matches('.service [data-action="details"]')){
        const card = btn.closest('.service');
        const id = Number(card.dataset.id);
        const it = state.catalog.find(s=>s.id==id);
        if(it){ $('#dTitle').textContent = it.title; $('#dBody').innerHTML = `
          <p><strong>Plateforme :</strong> ${it.platform}</p>
          <p><strong>SKU :</strong> ${it.sku||'-'}</p>
          <p><strong>Quantit√© :</strong> ${it.min} - ${it.max}</p>
          <p><strong>Vitesse :</strong> ${it.speed}</p>
          <p class="muted">${it.desc}</p>`; $('#detailsModal').classList.add('open'); $('#detailsModal').setAttribute('aria-hidden','false'); }
      }
    });

    // close details
    $('#closeDetails').onclick = ()=>{ $('#detailsModal').classList.remove('open'); $('#detailsModal').setAttribute('aria-hidden','true'); };

    // search behavior (instant alpha)
    let searchTimer;
    $('#search').addEventListener('input', ()=>{
      clearTimeout(searchTimer);
      searchTimer = setTimeout(()=>{ state.page=1; renderGrid(); }, 80);
    });
    $('#platform').addEventListener('change', ()=>{ state.page=1; renderGrid(); });

    // Language quick (click pill cycles)
    $('#langBadge').onclick = ()=>{ const idx = CONFIG.LANGUAGES.indexOf(state.lang); const next = CONFIG.LANGUAGES[(idx+1)%CONFIG.LANGUAGES.length]; setLang(next); };

    /**********************
     * NEWS (demo 15 items + rotate daily)
     **********************/
    const DEMO_NEWS = (()=>{
      const arr = [
        {title:"TikTok teste de nouvelles options de mon√©tisation", img:"https://images.unsplash.com/photo-1526378722484-bd91ca387e72?q=80&w=1200&auto=format&fit=crop", src:"TechCrunch", url:"#", date:"2025-08-10"},
        {title:"Instagram Reels : mise √† jour de l‚Äôalgorithme", img:"https://images.unsplash.com/photo-1557821552-17105176677c?q=80&w=1200&auto=format&fit=crop", src:"The Verge", url:"#", date:"2025-08-11"},
        {title:"YouTube exp√©rimente les r√©sum√©s IA", img:"https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=1200&auto=format&fit=crop", src:"Wired", url:"#", date:"2025-08-12"},
        {title:"X (Twitter) d√©ploie un nouveau format d‚Äôannonces", img:"https://images.unsplash.com/photo-1517292987719-0369a794ec0f?q=80&w=1200&auto=format&fit=crop", src:"Bloomberg", url:"#", date:"2025-08-13"},
        {title:"Reddit : outils avanc√©s pour communaut√©s pro", img:"https://images.unsplash.com/photo-1526498460520-4c246339dccb?q=80&w=1200&auto=format&fit=crop", src:"The Information", url:"#", date:"2025-08-09"},
        {title:"Kik : cr√©ateurs gaming en pleine croissance", img:"https://images.unsplash.com/photo-1599507593362-50fa53ed0d0c?q=80&w=1200&auto=format&fit=crop", src:"CoinDesk", url:"#", date:"2025-08-08"},
        {title:"Facebook : nouvelles r√®gles transparence pubs", img:"https://images.unsplash.com/photo-1541560052-77ec1bbc09f7?q=80&w=1200&auto=format&fit=crop", src:"FT", url:"#", date:"2025-08-07"},
        {title:"LinkedIn renforce les analytics de pages", img:"https://images.unsplash.com/photo-1552581234-26160f608093?q=80&w=1200&auto=format&fit=crop", src:"TechRadar", url:"#", date:"2025-08-06"},
        {title:"Telegram : supergroupes, mod√©ration assist√©e IA", img:"https://images.unsplash.com/photo-1516850104916-58b516fe75b0?q=80&w=1200&auto=format&fit=crop", src:"Ars Technica", url:"#", date:"2025-08-05"},
        {title:"Discord : Nitro √©volue, nouveaux perks", img:"https://images.unsplash.com/photo-1556157382-97eda2d62296?q=80&w=1200&auto=format&fit=crop", src:"The Verge", url:"#", date:"2025-08-04"},
        {title:"Twitch : boost discovery cat√©gories IRL", img:"https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1200&auto=format&fit=crop", src:"IGN", url:"#", date:"2025-08-03"},
        {title:"Snapchat : Lenses pro pour marques", img:"https://images.unsplash.com/photo-1545239351-1141bd82e8a6?q=80&w=1200&auto=format&fit=crop", src:"AdAge", url:"#", date:"2025-08-02"},
        {title:"OnlyFans : outils anti-fraude renforc√©s", img:"https://images.unsplash.com/photo-1526378722484-bd91ca387e72?q=80&w=1200&auto=format&fit=crop", src:"BBC", url:"#", date:"2025-08-01"},
        {title:"Spotify : tests de formats interactifs", img:"https://images.unsplash.com/photo-1470225620780-dba8ba36b745?q=80&w=1200&auto=format&fit=crop", src:"Billboard", url:"#", date:"2025-07-31"},
        {title:"YouTube Shorts : nouveaux analytics cr√©ateurs", img:"https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1200&auto=format&fit=crop", src:"9to5Google", url:"#", date:"2025-07-30"}
      ];
      // rotate daily deterministically
      const day = new Date().toISOString().slice(0,10).replace(/-/g,'');
      const seed = Number(day) % arrLen(); // small rotation
      function arrLen(){ return arrLength = arrLen.value|| (arrLen.value = arr.length); }
      // we'll simply shift by day % len
      const shift = Number(day) % arr.length;
      return arr.slice(shift).concat(arr.slice(0,shift));
    })();

    function renderNews(list){
      const root = $('#newsGrid');
      root.innerHTML = list.slice(0,15).map(n=>`
        <article class="news-card">
          <img src="${n.img}" alt="">
          <div class="news-pad">
            <div class="small muted">${n.src} ‚Ä¢ ${n.date}</div>
            <strong>${n.title}</strong>
            <div style="margin-top:8px"><a class="btn" href="${n.url}" target="_blank" rel="noopener">Lire</a></div>
          </div>
        </article>
      `).join('');
      twemoji.parse(root);
    }

    /**********************
     * CHAT IA (front -> proxy)
     **********************/
    function appendChat(msg, who='ai'){
      const div = document.createElement('div'); div.className='chat-msg ' + (who==='ai'?'ai':'user'); div.innerHTML = msg; $('#chatBody').appendChild(div); $('#chatBody').scrollTop = $('#chatBody').scrollHeight;
      twemoji.parse(div);
    }

    async function sendToAI(message){
      appendChat(message,'user');
      appendChat('‚Ä¶','ai'); // temporary
      try{
        const res = await fetch(CONFIG.CHAT_API_ENDPOINT, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ message, lang: state.lang }) });
        if(!res.ok) throw new Error('AI proxy error');
        const json = await res.json();
        // replace last AI placeholder
        const aiNodes = Array.from(document.querySelectorAll('.chat-msg.ai'));
        const last = aiNodes[aiNodes.length-1]; if(last) last.innerHTML = json.reply || 'D√©sol√©, pas de r√©ponse.';
        twemoji.parse(last);
      }catch(e){
        const aiNodes = Array.from(document.querySelectorAll('.chat-msg.ai'));
        const last = aiNodes[aiNodes.length-1]; if(last) last.innerHTML = "Impossible de contacter l'IA pour le moment.";
      }
    }

    $('#openChat').onclick = ()=>{ $('#chatPanel').classList.add('open'); $('#chatPanel').setAttribute('aria-hidden','false'); $('#chatInput').focus(); };
    $('#closeChat').onclick = ()=>{ $('#chatPanel').classList.remove('open'); $('#chatPanel').setAttribute('aria-hidden','true'); };
    $('#chatSend').onclick = ()=>{ const v = $('#chatInput').value.trim(); if(!v) return; $('#chatInput').value=''; sendToAI(v); };
    $('#chatInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); $('#chatSend').click(); } });

    /**********************
     * INIT
     **********************/
    (function init(){
      // default language
      setLang('fr');
      // load demo catalog
      state.catalog = buildDemoCatalog();
      renderGrid();
      renderNews(DEMO_NEWS || []);
      // mount paypal after a short delay to allow SDK load
      setTimeout(()=>{ try{ mountPayPal(); }catch(e){} }, 1200);
      document.getElementById('year').textContent = new Date().getFullYear();
      // parse emojis site-wide
      if(window.twemoji){ twemoji.parse(document.body); }
      // accessibility: ESC to close modals/drawers
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ document.querySelectorAll('.drawer, .drawer-cart, .modal, .chat-panel').forEach(el=>el.classList.remove('open')); }});
      // simple clickable top menu anchors
      $('#btnNews').onclick = ()=>{ document.getElementById('news').scrollIntoView({behavior:'smooth'}); };
      $('#btnFAQ').onclick = ()=>{ document.getElementById('faq').scrollIntoView({behavior:'smooth'}); };
      $('#btnLegal').onclick = ()=>{ document.getElementById('legal').scrollIntoView({behavior:'smooth'}); };
      $('#btnCatalogue').onclick = ()=>{ document.getElementById('catalogue').scrollIntoView({behavior:'smooth'}); $('#search').focus(); };
      // page controls
      document.querySelectorAll('[data-action="next"]').forEach(b=>b.onclick=()=>{ state.page++; renderGrid(); });
    })();
  </script>
</body>
</html>
